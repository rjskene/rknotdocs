

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Viral Spread Theory in RKnot &mdash; RKnot  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}}, "tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Key Concepts" href="concepts.html" />
    <link rel="prev" title="Introduction" href="intro.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> RKnot
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
</ul>
<p class="caption"><span class="caption-text">ARCHITECTURE</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Viral Spread Theory in RKnot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#R_0"><span class="math notranslate nohighlight">\(R_0\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="#Static-Transmission-Risk">Static Transmission Risk</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Expected-Contact-Rate">Expected Contact Rate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Likelihood-of-Transmission">Likelihood of Transmission</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Dynamic-Transmission-Risk">Dynamic Transmission Risk</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Hutch-Model">Hutch Model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Other-Forms-of-Heterogeneity">Other Forms of Heterogeneity</a></li>
<li class="toctree-l2"><a class="reference internal" href="#The-Average-Contact">The Average Contact</a></li>
<li class="toctree-l2"><a class="reference internal" href="#References">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Key Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="sizing.html">Sizing</a></li>
</ul>
<p class="caption"><span class="caption-text">SIMULATIONS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hit.html">SIR: Factors Influencing Spread</a></li>
<li class="toctree-l1"><a class="reference internal" href="load.html">Dynamic Transmission Risk</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi.html">Multiple Jurisdictions</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">RKnot</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Viral Spread Theory in RKnot</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/theory.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Viral-Spread-Theory-in-RKnot">
<h1>Viral Spread Theory in RKnot<a class="headerlink" href="#Viral-Spread-Theory-in-RKnot" title="Permalink to this headline">¬∂</a></h1>
<p><em>RKnot</em> is built up from the contact level. A contact is an interaction between an infected person and a susceptible person that could result in transmission of the virus (more details <a class="reference external" href="#Average-Contact">below</a>). Contacts occur in a 2d environment in which subjects move randomly according to pre-defined distributions or deterministically according to event subscription.</p>
<p>When a contact occurs, transmission is determined stochastically according to a multi-faceted likelihood of transmission tailored specifically to the infected and susceptible subjects in contact at the specific time at the specific location.</p>
<p>The expected number of new infections at any time, can be found as the sum of all contacts at that time multiplied each contact‚Äôs specific transmission risk.</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
E(n_{infs}) = \sum_{i=1}^N c_i*\tau_i
\end{equation}\]</div>
<p><span class="math notranslate nohighlight">\(\tau\)</span> is a fundamental property of virus that can be further augmented for properties of the infected, or the subject, or the location of the contact.</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\tau_i = \tau * T_{inf,i} * T_{sus,i} * T_{loc,i}
\end{equation}\]</div>
<p>Thus, the transmission risk of the virus is required in order to mimick its spread. This can be provided directly or derived from a virus‚Äô estimated <span class="math notranslate nohighlight">\(R_0\)</span>.</p>
<div class="section" id="R_0">
<h2><span class="math notranslate nohighlight">\(R_0\)</span><a class="headerlink" href="#R_0" title="Permalink to this headline">¬∂</a></h2>
<p>The propensity for a virus to spread is most-commonly referenced by its Basic Reproduction Number, <span class="math notranslate nohighlight">\(R_0\)</span>. <span class="math notranslate nohighlight">\(R_0\)</span> is the number of new infections that will be caused by a single infected person in an entirely susceptible population.</p>
<p>At an individual level, <span class="math notranslate nohighlight">\(R_0\)</span> is influenced by many factors: the number of contacts the infected person has, the location of contacts, the social setting of contacts, etc.</p>
<p>At a population level, many models of <span class="math notranslate nohighlight">\(R_0\)</span> assume that the individual factors average out, thus leaving us with a property that is fundamental to the virus itself. We can see there is a broad range of <span class="math notranslate nohighlight">\(R_0\)</span> values for different viruses in the <a class="reference external" href="https://en.wikipedia.org/wiki/Basic_reproduction_number">wikipedia entry</a>.</p>
<p><span class="math notranslate nohighlight">\(R_0\)</span> can be described as:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
R_0=\beta*d
\end{equation}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
\\\textit{where: }\beta \textit{ = transmission rate (infections / day)}
\\ d \textit{ = duration of infection (days)}
\end{equation}\end{split}\]</div>
<p>The above ignores the number of contacts made, however, <span class="math notranslate nohighlight">\(\beta\)</span> can be further broken down as:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\beta=\tau*\overline{c}
\end{equation}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
\\\textit{where: }\tau \textit{ = probability of transmission, or transmission risk}
\\\overline{c}\textit{ = contacts per day}
\end{equation}\end{split}\]</div>
<p>which yields:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
R_0=\tau*\overline{c}*d
\end{equation}\]</div>
<p>Using the relationship above, we can simulate viral spread contact by contact, however, we must have a value(s) for <span class="math notranslate nohighlight">\(\tau\)</span>.</p>
</div>
<div class="section" id="Static-Transmission-Risk">
<h2>Static Transmission Risk<a class="headerlink" href="#Static-Transmission-Risk" title="Permalink to this headline">¬∂</a></h2>
<p>There are many mathematical models used to describe viral transmission, the most commonly-referenced being the <a class="reference external" href="https://web.stanford.edu/~jhj1/teachingdocs/Jones-on-R0.pdf">SIR model</a> (Suscepitble-Infected-Recovered).</p>
<p>The SIR model makes several simplifying assumptions:</p>
<ul class="simple">
<li><p>Closed, well-mixed population with no demography</p></li>
<li><p>Constant Rates</p></li>
</ul>
<p>This allows viral spread to be described in 3 equations.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
\frac{ds}{dt} = ‚àí\beta si
\\\frac{di}{dt} = \beta si - id^{-1}
\\\frac{dr}{dt} = di
\end{equation}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\textit{where: }s = S/N = \textit{number of susceptible / total population size}
\\\textit{where: }i = I/N = \textit{number of infected / total population size}
\\\textit{where: }s = R/N = \textit{number of recovered / total population size}\end{split}\]</div>
<p>The simplified model allows for some quick estimates of various spread characteristics. Herd Immunity threshold, for instance, can be found as:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\text{HIT} = 1 - 1/R_0
\end{equation}\]</div>
<p>For instance, <span class="math notranslate nohighlight">\(R_0\)</span> of 2.5x, <a class="reference external" href="https://www.cdc.gov/coronavirus/2019-ncov/hcp/planning-scenarios.html">the prevailing estimate for sars-cov-2</a>, yields a HIT of 60%.</p>
<p>The assumption of constant rates presents problems for simulating at the contact level, however. SIR assumes that transmission risk is constant during the infection period and that each subject in the population has the same number of contacts and so is able to ignore <span class="math notranslate nohighlight">\(\tau\)</span> and <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p>Referring to equation (5) above:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R_0\)</span> is known (from external analysis and provided by the user)</p></li>
<li><p><span class="math notranslate nohighlight">\(d\)</span> is known (from external analysis and provided by the user)</p></li>
</ul>
<p>Thus, unknowns are <span class="math notranslate nohighlight">\(\tau\)</span> &amp; <span class="math notranslate nohighlight">\(\overline{c}\)</span></p>
<p>As per above, we must know <span class="math notranslate nohighlight">\(\tau\)</span> in order to simulate spread.</p>
<div class="section" id="Expected-Contact-Rate">
<h3>Expected Contact Rate<a class="headerlink" href="#Expected-Contact-Rate" title="Permalink to this headline">¬∂</a></h3>
<p>While we do not know <span class="math notranslate nohighlight">\(\overline{c}\)</span>, the simulation space is given a number of parameters that allow us to estimate the expected number of contacts. We know:</p>
<ul class="simple">
<li><p>The population size</p></li>
<li><p>The number of locations</p></li>
<li><p>The movement patterns of subjects</p></li>
<li><p>The likelihood that a subject will be at a particular location at a particular time given 1/2/3 above</p></li>
</ul>
<p>A simple method to estimate <span class="math notranslate nohighlight">\(\overline{c}\)</span> is to assume that each subject is equally likely to be in any one location at any time. The probability of a single dot being in a singe location is:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
P(LOC_{xy},DOT_i)=1/N
\end{equation}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
\\\textit{where:}\;xy\;\textit{= coordinates of the location}
\\N\textit{ = number of locations}
\end{equation}\end{split}\]</div>
<p>The probability of another dot being there at the same time:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
P(LOC_{xy},DOT_{ij})=1/N*1/N
\end{equation}\]</div>
<p>The probability of <span class="math notranslate nohighlight">\(k\)</span> dots being at the same location at the same time:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
P(LOC_{xy},DOT_{ij})=1/N^k
\end{equation}\]</div>
<p>Then, the number of ordered contacts is:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\sum_{i=1}^k(1 / N^k)
\end{equation}\]</div>
<p>And for all possible orders:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
E(\overline{c})=k*\sum_{i=1}^k(1/N^k)
\end{equation}\]</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<p>The result is a contact rate that is closely related to the density of the simulation space. For example, a population of 100 subjects in a space of 100 locations, would have an expected contact rate of 1.01 per day</p>
</div>
</div>
<p>In fact, we can prove that the contact rate for an equal mover is the density using probability theory. We can view the probability of contact with other dots in the space as a binomial random variable with the <em>trials</em> representing the number of dots at a location, so:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
B(k - 1, 1 / N)
\\
\textit{k is the number of dots}
\\
\textit{N is the number of locations}
\end{equation}\end{split}\]</div>
<p>If there are three dots (and 3 locations), the distribution governing their interactions is the sum of the two Binomial functions:</p>
<div class="math notranslate nohighlight">
\[B(2 - 1, 1 / 3) + B(2 - 1, 1 / 3)\]</div>
<p>We know the <a class="reference external" href="http://web.stanford.edu/class/archive/cs/cs109/cs109.1182/lectures/15%20Convolution.pdf">sum of two Binomial distributions</a> is:</p>
<div class="math notranslate nohighlight">
\[B(m, p) + B(n, p) = B(m+n, p)\]</div>
<p>so:</p>
<div class="math notranslate nohighlight">
\[B(2 - 1, 1 / 3) + B(2 - 1, 1 / 3) = B(2, 1 / 3)\]</div>
<p>and for k dots:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\sum_k^i B(n_i, 1/N) = B(\sum_k^in_i, 1/N)\;\text{where: } n_i = 1
\end{equation}\]</div>
<p>which simplifies to:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
B(k, 1/N)
\end{equation}\]</div>
<p>and we know the mean of a binomial distribution is the product <span class="math notranslate nohighlight">\(n*p\)</span></p>
<div class="math notranslate nohighlight">
\[\mu = np = k / N = density\]</div>
<p>We can see that relationship below, where an environment with density of 5 generates a <span class="math notranslate nohighlight">\(\overline{k}\)</span> of 5.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[85]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">st</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">density</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_dots</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">n_locs</span> <span class="o">=</span> <span class="n">n_dots</span> <span class="o">//</span> <span class="n">density</span>

<span class="c1"># binom always returns n + 1</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">n_locs</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">n_dots</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">kontact</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

<span class="n">counts</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">100000</span><span class="p">),</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=.</span><span class="mi">9</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">+.</span><span class="mi">5</span><span class="p">,</span> <span class="n">kontact</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="n">i</span><span class="o">+.</span><span class="mi">5</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Contacts&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;$\mu$: </span><span class="si">{</span><span class="n">n</span><span class="o">*</span><span class="n">p</span><span class="si">}</span><span class="s1"> contacts / day&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span> <span class="c1"># Or any color</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;imgs/binom.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/theory_14_0.png" src="_images/theory_14_0.png" />
</div>
</div>
</div>
<div class="section" id="Likelihood-of-Transmission">
<h3>Likelihood of Transmission<a class="headerlink" href="#Likelihood-of-Transmission" title="Permalink to this headline">¬∂</a></h3>
<p>With the expected contact rate known, probability of transmission under the SIR model is found as:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\tau=\frac{R_0}{ùëë*\overline{c}}
\end{equation}\]</div>
<p>So, again, If a susceptible subject has contact with an infected at the same location, at any time, its probability of infection is:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\tau_i = \tau * T_{inf,i} * T_{sus,i} * T_{loc,i}
\end{equation}\]</div>
<p>If a susceptible comes in contact with multiple infected, we assume that this results in multiple contacts that occur in succession. So we must sum all the branches of the probability tree that end in an infection:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\sum^N_{i=1}(1-\tau_i)^n*\tau_i
\end{equation}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
\\\textit{where:}\;\tau_i\;\textit{= likelihood of transmission for contact i}
\\N\;\textit{= number of infected dots}
\end{equation}\end{split}\]</div>
<p>This ensures that the likelihood of transmission is asymptotic to 1, as follows:</p>
<p><img alt="Drawing" src="https://storage.googleapis.com/rknotvids/imgs/tau_v_contacts.png" /></p>
</div>
</div>
<div class="section" id="Dynamic-Transmission-Risk">
<h2>Dynamic Transmission Risk<a class="headerlink" href="#Dynamic-Transmission-Risk" title="Permalink to this headline">¬∂</a></h2>
<p>The SIR model makes several assumptions that make for simpler math, but that do not map well onto reality.</p>
<p>In particular, SIR assumes constant transmission risk,</p>
<div class="math notranslate nohighlight">
\[\tau\]</div>
<p>, when in reality, we know that the infectiousness of an individual changes over time as a function of viral load. It takes time for the virus to accumulate in the subject and, then, in turn it takes time for the subject to dimish the virus via its immune response.</p>
<p>Generally, the greater the viral load, the greater the transmission risk. And so the likelihood of transmission should follow a similar pattern as the viral load (or vice versa). This <a class="reference external" href="https://www.nytimes.com/interactive/2020/10/02/science/charting-a-coronavirus-infection.html?s=03">New York Times piece</a> has a nice visualisation of this concept for sar-cov-2.</p>
<p>There are several techinques available for incorporating viral load in a viral spread model including serial interval, explored <a class="reference external" href="https://www.ijidonline.com/article/S1201-9712%2820%2930119-3/pdf">here</a> and generation time, explored <a class="reference external" href="https://www.medrxiv.org/content/10.1101/2020.03.08.20032946v1.full.pdf">here</a>. These techniques, however, again tend to ignore <span class="math notranslate nohighlight">\(\overline{c}\)</span> and focus on <span class="math notranslate nohighlight">\(\beta\)</span>.</p>
<div class="section" id="Hutch-Model">
<h3>Hutch Model<a class="headerlink" href="#Hutch-Model" title="Permalink to this headline">¬∂</a></h3>
<p>A paper from a team at the <a class="reference external" href="https://www.medrxiv.org/content/10.1101/2020.08.07.20169920v3.full.pdf">Fred Hutchinson Cancer Research Center</a>, however, maps transmission risk directly onto an estimated viral load curve and infectiousness factor and optimizes it at a specfic contact rate and contact variance (hence forth known as the Hutch model).</p>
<p>First, we will show how the dynamic transmission risk curve is derived. The goal is to produce an array of non-zero probabilites reflecting the likelihood of transmission of virus from one infected to a susceptible in a single contact, based on the known viral load characteristics of the virus.</p>
<p>The Fred model combines quantities of infectiousness and viral load. Viral load is found via a system of 6 differential equations as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
\frac{ds}{dt} = -\beta vs
\\\frac{di}{dt} = \beta vs - \delta i^ki - mi\frac{e^r}{e^r+\phi^r}
\\\frac{dv}{dt} = \pi i - \gamma v
\\\frac{dM_1}{dt} = \omega iM_1 - qM_1
\\\frac{dM_2}{dt} = q(M_1 - M_2)
\\\frac{de}{dt} = q(M_2 - \delta_eE
\end{equation}\end{split}\]</div>
<p>The variable <code class="docutils literal notranslate"><span class="pre">v</span></code> is the viral load.</p>
<p>With viral load known, the transmission risk, <span class="math notranslate nohighlight">\(\tau\)</span>, can be found as:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\tau_t = \frac{v(t)^\alpha}{\gamma^\alpha + v(t)^\alpha}
\end{equation}\]</div>
<p>The paper provides estimates for several of the parameters including <span class="math notranslate nohighlight">\(\gamma\)</span>, <span class="math notranslate nohighlight">\(\alpha\)</span>, etc. The system can be described and solved using the <code class="docutils literal notranslate"><span class="pre">odeint</span></code> method in <code class="docutils literal notranslate"><span class="pre">scipy</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>

<span class="k">def</span> <span class="nf">inf_rate</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">beta</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">s</span>

<span class="k">def</span> <span class="nf">sfunc</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">inf_rate</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">vfunc</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">v</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">pi</span><span class="o">*</span><span class="n">i</span> <span class="o">-</span> <span class="n">c</span><span class="o">*</span><span class="n">v</span>

<span class="k">def</span> <span class="nf">ifunc</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
    <span class="n">inf_r</span> <span class="o">=</span> <span class="n">inf_rate</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
    <span class="n">dens_rate</span> <span class="o">=</span> <span class="n">delta</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="n">k</span><span class="p">)</span>
    <span class="n">acq_res</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">e</span><span class="o">**</span><span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">e</span><span class="o">**</span><span class="n">r</span> <span class="o">+</span> <span class="n">phi</span><span class="o">**</span><span class="n">r</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">inf_r</span> <span class="o">-</span> <span class="n">dens_rate</span><span class="o">*</span><span class="n">i</span> <span class="o">-</span> <span class="n">acq_res</span><span class="o">*</span><span class="n">i</span>

<span class="k">def</span> <span class="nf">m1func</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">omega</span><span class="o">*</span><span class="n">i</span><span class="o">*</span><span class="n">m1</span> <span class="o">-</span> <span class="n">q</span><span class="o">*</span><span class="n">m1</span>

<span class="k">def</span> <span class="nf">m2func</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">q</span> <span class="o">*</span> <span class="p">(</span><span class="n">m1</span><span class="o">-</span><span class="n">m2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">efunc</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">dE</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">q</span><span class="o">*</span><span class="n">m2</span> <span class="o">-</span> <span class="n">dE</span><span class="o">*</span><span class="n">e</span>

<span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
    <span class="n">beta</span><span class="o">=</span><span class="mi">10</span><span class="o">**-</span><span class="mf">7.23</span>
    <span class="n">k</span><span class="o">=</span><span class="mf">0.08</span>
    <span class="n">delta</span><span class="o">=</span> <span class="mf">3.13</span>
    <span class="n">pi</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mf">2.59</span>
    <span class="n">m</span><span class="o">=</span><span class="mf">3.21</span>
    <span class="n">omega</span><span class="o">=</span><span class="mi">10</span><span class="o">**-</span><span class="mf">4.55</span>
    <span class="n">r</span><span class="o">=</span><span class="mi">10</span>
    <span class="n">dE</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">q</span><span class="o">=</span><span class="mf">2.4</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">5</span>
    <span class="n">c</span><span class="o">=</span><span class="mi">15</span>

    <span class="n">s</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>

    <span class="n">dsdt</span> <span class="o">=</span> <span class="n">sfunc</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">didt</span> <span class="o">=</span> <span class="n">ifunc</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
    <span class="n">dvdt</span> <span class="o">=</span> <span class="n">vfunc</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
    <span class="n">dm1dt</span> <span class="o">=</span> <span class="n">m1func</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
    <span class="n">dm2dt</span> <span class="o">=</span> <span class="n">m2func</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span>
    <span class="n">dedt</span> <span class="o">=</span> <span class="n">efunc</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">dE</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

    <span class="n">dzdt</span> <span class="o">=</span> <span class="p">[</span><span class="n">dsdt</span><span class="p">,</span><span class="n">didt</span><span class="p">,</span><span class="n">dvdt</span><span class="p">,</span><span class="n">dm1dt</span><span class="p">,</span><span class="n">dm2dt</span><span class="p">,</span><span class="n">dedt</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">dzdt</span>

<span class="c1"># FROM PRIOR RESEARCH</span>
<span class="n">pi</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mf">2.59</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">S0</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">7</span>
<span class="n">I0</span><span class="o">=</span><span class="mi">1</span>
<span class="n">V0</span><span class="o">=</span><span class="n">pi</span><span class="o">*</span><span class="n">I0</span><span class="o">/</span><span class="n">c</span>
<span class="n">M10</span><span class="o">=</span><span class="mi">1</span>
<span class="n">M20</span><span class="o">=</span><span class="mi">0</span>
<span class="n">E0</span><span class="o">=</span><span class="mi">0</span>
<span class="n">phi</span><span class="o">=</span><span class="mi">100</span>
<span class="n">z0</span> <span class="o">=</span> <span class="p">[</span><span class="n">S0</span><span class="p">,</span> <span class="n">I0</span><span class="p">,</span> <span class="n">V0</span><span class="p">,</span> <span class="n">M10</span><span class="p">,</span> <span class="n">M20</span><span class="p">,</span> <span class="n">E0</span><span class="p">]</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">v</span><span class="o">=</span> <span class="n">z</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>This results in the curve below, which shows the level of virus present in an infected person over time.</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/theory_23_0.png" src="_images/theory_23_0.png" />
</div>
</div>
<p>We can see that sars-cov-2 viral load can have a long tail, however, the Hutch paper showed that the amount of virus present during the tail is unlikely to result in high transmission, as per below.</p>
<p>Transmission risk is derived from the viral load above as well as two properties of the infectiousness of the subjects in the contact, <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\gamma\)</span> (see the paper for more details).</p>
<p>The paper estimated <span class="math notranslate nohighlight">\(\alpha\)</span> = 0.8 and <span class="math notranslate nohighlight">\(\gamma\)</span> = <span class="math notranslate nohighlight">\(10^7\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">infness</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
    <span class="n">num</span> <span class="o">=</span> <span class="n">v</span><span class="o">**</span><span class="n">alpha</span>
    <span class="n">den</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">**</span><span class="n">alpha</span> <span class="o">+</span> <span class="n">v</span><span class="o">**</span><span class="n">alpha</span>
    <span class="k">return</span> <span class="n">num</span><span class="o">/</span><span class="n">den</span>

<span class="k">def</span> <span class="nf">taufunc</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">infness</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">7</span>

<span class="n">vlin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>
<span class="n">tmr</span> <span class="o">=</span> <span class="n">taufunc</span><span class="p">(</span><span class="n">vlin</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">tmr</span></code> is the transmission risk curve that we will utilize in our simulations. It is a 1d array with each element representing the likelihood of transmission of the virus at that point in the infection‚Äôs life cycle.</p>
<p>We can see from the plot below, that transmission risk only increases materially at exponentially higher viral loads:</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/theory_27_0.png" src="_images/theory_27_0.png" />
</div>
</div>
<p>We can further combine Chart 1 and Chart 2 above to show that transmission of sars-cov-2 is likely only during a very narrow range in the early stage of infection.</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/theory_29_0.png" src="_images/theory_29_0.png" />
</div>
</div>
<p>Note that there is only a significant risk of transmission of the virus for during the first few days of the infection period (shown as the more orange color under the curve).</p>
<p>If we assume random <span class="math notranslate nohighlight">\(\tau\)</span> values from <code class="docutils literal notranslate"><span class="pre">tmr</span></code> curve above for 30 different infected dots, the likelihood of transmission to a susceptible as a function of the number of dots at the same location, scales as follows:</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/theory_34_0.png" src="_images/theory_34_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Other-Forms-of-Heterogeneity">
<h2>Other Forms of Heterogeneity<a class="headerlink" href="#Other-Forms-of-Heterogeneity" title="Permalink to this headline">¬∂</a></h2>
<p><strong>RKnot</strong> seeks to address the shortfalls in <span class="math notranslate nohighlight">\(R_0\)</span> models by allowing the user to introduce customized, heterogeneous populations across several axis including:</p>
<ul class="simple">
<li><p><strong>Fatality Rate</strong></p></li>
<li><p><strong>Population Density</strong></p></li>
<li><p><strong>Movement</strong> - frequency and distance of location changes in space according to different probability distributions.</p></li>
<li><p><strong>Events</strong> - in the real world, people do not move and interact according to smooth probability functions. In fact, they typically have a small subset of movements that are huge outliers from any distribution. These are the professional sporting events, vacation trips, church functions, house parties, etc. that are scheduled and often times recurring. Thankfully, they are more often than not deterministic, which allows us to incorporate them in a simulation.</p></li>
<li><p><strong>Susceptibility</strong> - segments of population can be made immune (without requiring vaccination) to mimick phenomenon like <a class="reference external" href="https://www.bmj.com/content/370/bmj.m3563">possible T-cell immunity</a>.</p></li>
<li><p><strong>Subject Transmission Factor</strong>, <span class="math notranslate nohighlight">\(T_i\)</span>: <span class="math notranslate nohighlight">\(R_0\)</span> assumes that all contacts have the same transmission risk, <span class="math notranslate nohighlight">\(\tau\)</span> (subject to the viral load at the time of the interaction). <strong>RKnot</strong> introduces a unitless Transmission Factor, <span class="math notranslate nohighlight">\(T\)</span>, for each subject at each contact that can modulate <span class="math notranslate nohighlight">\(\tau\)</span>. This can be used to mimick social distancing or mask wearing or different socio-cultural norms that may impact spread (i.e.¬†east Asian bows versus southern European
double-kisses).</p></li>
</ul>
<p><em>Still To Be Incorporated</em></p>
<ul class="simple">
<li><p><strong>Location Transmission Factor</strong>, <span class="math notranslate nohighlight">\(T_{\text{xy}}\)</span>: similar to <span class="math notranslate nohighlight">\(T_i\)</span> above, we can introduce a transmission factor to specific locations that might result in higher or lower likelihood of spread. This could be used to simulate certain work environments (like enclosed office spaces or meat-packing plants). It can also be used to mimic seasonality, by changing <span class="math notranslate nohighlight">\(T_{xy}\)</span> over time to account for, say, more time outdoors in temperate seasons.</p></li>
<li><p><strong>Testing and Isolation</strong> - with the heightened awareness of a pandemic, individuals in population are more likely to self-isolate or quarantine themselves upon sympton onset, thereby helping to reduce spread.</p></li>
</ul>
</div>
<div class="section" id="The-Average-Contact">
<h2>The Average Contact<a class="headerlink" href="#The-Average-Contact" title="Permalink to this headline">¬∂</a></h2>
<p>Currently, <strong>RKnot</strong> assumes that each and every contact is an <em>Average Contact</em>.</p>
<p>The average contact is a purely theoretical interaction that would result in about an average likelihood of transmission relative to all other possible interactions. It is not influenced by external factors such as the demographics of the subjects, the properties of the location, etc. Thus, the <span class="math notranslate nohighlight">\(\tau\)</span> of an Average Contact is a fundamental property of the virus.</p>
<p>I like to think of the Average Contact as the <em>Elevator Case</em>, i.e.:</p>
<ul class="simple">
<li><p>Two people on an elevator, standing three feet apart, having a conversation for several minutes before one person exits. No masks nor other conscious social distancing, but no particularly reckless behaviour either.</p></li>
</ul>
<p>Every other conceivable interaction can now be scaled relative to the Elevator Case on a continuum of higher or lower probability of transmission using transmission factors, <span class="math notranslate nohighlight">\(T\)</span>. For instance:</p>
<ul class="simple">
<li><p>two college students pressed closely together on a concert floor and yelling at the band on stage would have <span class="math notranslate nohighlight">\(T &gt;&gt;&gt; 1x\)</span></p></li>
<li><p>two people standing in a open field, 6 feet apart with masks on exchanging limited pleasantries would have <span class="math notranslate nohighlight">\(T &lt;&lt;&lt; 1x\)</span></p></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="References">
<h2>References<a class="headerlink" href="#References" title="Permalink to this headline">¬∂</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3782273/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3782273/</a></p></li>
<li><p><a class="reference external" href="https://www.bmj.com/content/370/bmj.m3563">https://www.bmj.com/content/370/bmj.m3563</a></p></li>
<li><p><a class="reference external" href="https://www.medrxiv.org/content/10.1101/2020.06.28.20142190v1">https://www.medrxiv.org/content/10.1101/2020.06.28.20142190v1</a></p></li>
<li><p><a class="reference external" href="https://fivethirtyeight.com/features/without-a-vaccine-herd-immunity-wont-save-us/">https://fivethirtyeight.com/features/without-a-vaccine-herd-immunity-wont-save-us/</a></p></li>
<li><p><a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3935673/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3935673/</a></p></li>
<li><p><a class="reference external" href="https://web.stanford.edu/~jhj1/teachingdocs/Jones-on-R0.pdf">https://web.stanford.edu/~jhj1/teachingdocs/Jones-on-R0.pdf</a></p></li>
<li><p><a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1804098/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1804098/</a></p></li>
<li><p><a class="reference external" href="https://www.ijidonline.com/article/S1201-9712%2820%2930119-3/pdf">https://www.ijidonline.com/article/S1201-9712%2820%2930119-3/pdf</a></p></li>
<li><p><a class="reference external" href="https://www.nytimes.com/interactive/2020/10/02/science/charting-a-coronavirus-infection.html?s=03">https://www.nytimes.com/interactive/2020/10/02/science/charting-a-coronavirus-infection.html?s=03</a></p></li>
<li><p><a class="reference external" href="https://www.ijidonline.com/article/S1201-9712%2820%2930119-3/pdf">https://www.ijidonline.com/article/S1201-9712%2820%2930119-3/pdf</a></p></li>
<li><p><a class="reference external" href="https://www.medrxiv.org/content/10.1101/2020.03.08.20032946v1.full.pdf">https://www.medrxiv.org/content/10.1101/2020.03.08.20032946v1.full.pdf</a></p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="concepts.html" class="btn btn-neutral float-right" title="Key Concepts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="intro.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2021 Ryan Skene. All rights reserved.

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>