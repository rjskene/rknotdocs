

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Sizing &mdash; RKnot  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}}, "tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="SIR: Factors Influencing Spread" href="hit.html" />
    <link rel="prev" title="Key Concepts" href="concepts.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> RKnot
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
</ul>
<p class="caption"><span class="caption-text">ARCHITECTURE</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="theory.html">Viral Spread Theory in RKnot</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Key Concepts</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Sizing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Importance-of-Distributions">Importance of Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Constant-Contact-Rate-and-Transmission-Risk">Constant Contact Rate and Transmission Risk</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Daily-Contact-Distribution">Daily Contact Distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Curve-Details">Curve Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Secondary-Infection-Distribution">Secondary Infection Distribution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Movement-Changes">Movement Changes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Local-Bias">Local Bias</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Interplay-of-Movement-and-Density">Interplay of Movement and Density</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Location-Clustering">Location Clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="#R_0-Distribution"><span class="math notranslate nohighlight">\(R_0\)</span> Distribution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Complex-Environments">Complex Environments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Hutch-Model:-R_0-of-1.8">Hutch Model: <span class="math notranslate nohighlight">\(R_0\)</span> of 1.8</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">SIMULATIONS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hit.html">SIR: Factors Influencing Spread</a></li>
<li class="toctree-l1"><a class="reference internal" href="load.html">Dynamic Transmission Risk</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi.html">Multiple Jurisdictions</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">RKnot</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Sizing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/sizing.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Sizing">
<h1>Sizing<a class="headerlink" href="#Sizing" title="Permalink to this headline">¶</a></h1>
<p>Appropriate sizing of a simulation environment is more art than science but we can use several tools in the <strong>RKnot</strong> package and the scientific literature to approximate appropriate attributes and initial conditions.</p>
<p>Our main guides for appropriate sizing:</p>
<ol class="arabic simple">
<li><p>Actual <span class="math notranslate nohighlight">\(R_0\)</span> should be close to target <span class="math notranslate nohighlight">\(R_0\)</span></p></li>
<li><p>Contact rate should follow a gamma distribution with parameters found in the <a class="reference external" href="https://www.medrxiv.org/content/10.1101/2020.08.07.20169920v3.full.pdf">Hutch model</a>.</p></li>
<li><p><span class="math notranslate nohighlight">\(R_0\)</span> distribution should replicate the <a class="reference external" href="https://wellcomeopenresearch.org/articles/5-67#ref-12">Endo distribution</a>.</p></li>
</ol>
<p>Our main tools for adjusting contact rates and <span class="math notranslate nohighlight">\(R_0\)</span> distribution are:</p>
<ul class="simple">
<li><p>Density</p></li>
<li><p><a class="reference internal" href="concepts.html#Mover-Functions"><span class="std std-ref">Mover functions</span></a></p></li>
<li><p><a class="reference internal" href="concepts.html#Events"><span class="std std-ref">Events</span></a></p></li>
<li><p><a class="reference internal" href="concepts.html#VBoxes"><span class="std std-ref">VBoxes</span></a></p></li>
</ul>
<hr class="docutils" />
<div class="section" id="Importance-of-Distributions">
<h2>Importance of Distributions<a class="headerlink" href="#Importance-of-Distributions" title="Permalink to this headline">¶</a></h2>
<p>Both the distribution of contacts <em>and</em> individual <span class="math notranslate nohighlight">\(R_0\)</span> are important considerations when formulating a realistic model of viral spread.</p>
<p>In terms of contacts, both frequency and timing are important. All else equal, an infected individual will cause more secondary infections if they have more contacts. BUT an infected individual contacting the same number of people at two different times is likely to cause more secondary infections at the time of greater viral load.</p>
<p>The SIR model makes many simplifying assumptions that fail to replicate real world spread. In particular, SIR is characterized by:</p>
<ul class="simple">
<li><p>Uniform, average contact rates</p></li>
<li><p>Constant transmission risk</p></li>
</ul>
<p>These two assumptions result in normally distributed contact rates among all individuals in an environment and normally distributed individual <span class="math notranslate nohighlight">\(R_0\)</span>.</p>
<p><a class="reference external" href="https://wellcomeopenresearch.org/articles/5-67#ref-12">Endo et al</a>, however, have suggested that 70%+ of all sars-cov-2 infections <em>lead to :math:`underline{text{NO}}` secondary infections.</em> And that the vast majority of secondary infections are due to a small minority of super-spreader carriers.</p>
<p>To account for this, the <a class="reference external" href="https://www.medrxiv.org/content/10.1101/2020.08.07.20169920v3.full.pdf">Hutch team</a> modelled contacts with a gamma distribution, which (relative to the Gaussian) favors many more instances of 0 contacts, but also allows for a very long tail of large contacts depending on the dispersion parameter.</p>
</div>
<hr class="docutils" />
<div class="section" id="Constant-Contact-Rate-and-Transmission-Risk">
<h2>Constant Contact Rate and Transmission Risk<a class="headerlink" href="#Constant-Contact-Rate-and-Transmission-Risk" title="Permalink to this headline">¶</a></h2>
<p>To replicate the Hutch approach in <strong>RKnot</strong>, we must first understand contact and transmission dynamics in more generalized scensarios.</p>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">looper</span></code> helper function to run 1,000 interations of simulations for two environments:</p>
<ol class="arabic simple">
<li><p>Equal Mover scenario with <code class="docutils literal notranslate"><span class="pre">density=1</span></code>.</p></li>
<li><p>Equal Mover with <code class="docutils literal notranslate"><span class="pre">density=5</span></code></p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rknot.helpers</span> <span class="kn">import</span> <span class="n">looper</span>

<span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">density</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">R0</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">infdur</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">sterile</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
<span class="n">group</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">n_inf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ifr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mover</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">,)</span>
<span class="n">contacts_1</span><span class="p">,</span> <span class="n">nsecs_1</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="n">looper</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>

<span class="n">params</span><span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">contacts_5</span><span class="p">,</span> <span class="n">nsecs_5</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="n">looper</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="Daily-Contact-Distribution">
<h3>Daily Contact Distribution<a class="headerlink" href="#Daily-Contact-Distribution" title="Permalink to this headline">¶</a></h3>
<p>The daily contact mean and variance are found simply as <code class="docutils literal notranslate"><span class="pre">contacts_1.mean()</span></code>, <code class="docutils literal notranslate"><span class="pre">contacts_1.var()</span></code>, etc. For each environment, the mean, variance, and density are about equal.</p>
<p>Seen as per table below:</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<table>
    <thead>
        <tr>
            <th class="results-table">Density, $\rho$</th>
            <th class="results-table">$\overline{{k}}$</th>
            <th class="results-table">$\sigma^2$</th>
        </tr>
    </thead>

    <tbody>
        <tr>
            <td class="results-table">1</td>
            <td class="results-table">0.9973</td>
            <td class="results-table">0.9731</td>
        </tr>
        <tr>
            <td class="results-table">5</td>
            <td class="results-table">4.9436</td>
            <td class="results-table">4.9607</td>
        </tr>
    </tbody>
</table></div>
</div>
<p>We can also see below that daily contacts are normally distributed in <em>both</em> environments (technically, <a class="reference internal" href="theory.html#Expected-Contact-Rate"><span class="std std-ref">binomially distributed as discussed here</span></a>).</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_10_0.png" src="_images/sizing_10_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div class="admonition note"><p class="admonition-title fa fa-exclamation-circle">SIR auto-adjusts for density</p><p>When $R_0$ and <em>infdur</em> are provided, <b>RKnot</b> will automatically scale the transmission risk such that the environment will produce the desired R0, regardless of the density. We can see this in the next comparison.</p></div></div>
</div>
</div>
<div class="section" id="Curve-Details">
<h3>Curve Details<a class="headerlink" href="#Curve-Details" title="Permalink to this headline">¶</a></h3>
<p>In the table below, we show the results of the simulations across the two environments.</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<table class="results-table"><thead><tr><th class="results-table"></th><th class="results-table" style="text-align: center;">$\rho$ = 1</th><th class="results-table" style="text-align: center;">$\rho$ = 5</th></tr></thead><tbody><tr><td class="results-table" style="text-align: left;">Peak</td><td class="results-table" style="text-align: center;">40.1%</td><td class="results-table" style="text-align: center;">38.6%</td></tr><tr><td class="results-table" style="text-align: left;">HIT</td><td class="results-table" style="text-align: center;">61.6%</td><td class="results-table" style="text-align: center;">59.5%</td></tr><tr><td class="results-table" style="text-align: left;">Total</td><td class="results-table" style="text-align: center;">82.4%</td><td class="results-table" style="text-align: center;">79.5%</td></tr><tr><td class="results-table" style="text-align: left;">Days to Peak</td><td class="results-table" style="text-align: center;">66</td><td class="results-table" style="text-align: center;">64</td></tr></tbody></table></div>
</div>
<p>Both environments do a decent job of meeting the expected HIT. With <span class="math notranslate nohighlight">\(R_0\)</span> of 2.5 (and assuming SIR conditions), HIT is generally understood to be <span class="math notranslate nohighlight">\(1 - 1/R_0 = 1 - 1 / 2.5 =\)</span> 60%</p>
<p>That said, this is in part due to the fact that ~10% of all simulations ended with <em>no secondary infections</em>, so most simulations ended with between 65% and 75% HIT as per below:</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_15_0.png" src="_images/sizing_15_0.png" />
</div>
</div>
</div>
<div class="section" id="Secondary-Infection-Distribution">
<h3>Secondary Infection Distribution<a class="headerlink" href="#Secondary-Infection-Distribution" title="Permalink to this headline">¶</a></h3>
<p>Now, we compare the <span class="math notranslate nohighlight">\(R_0\)</span> generated in each simulation of the two environments. Each chart below shows the actual number of secondary infections generated in each of 1,000 simulations with two different distributions overlayed.</p>
<ul class="simple">
<li><p>a Binomial distribution deterimined as follows:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
B(n,p) = B(\text{infdur} * \overline{k}, \frac{R_0 / \text{infdur}}{\overline{k}})
\\where: n = \overline{c} = \text{infdur} * \overline{k}
\\ p = R_0 / \overline{k} / \text{infdur}
\\ \overline{c} = \text{average total contacts}
\\ \overline{k} = \text{average daily contact rate}
\end{equation}\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\frac{R_0}{\textit{infdur}}\)</span> number of infections occuring during each day and <span class="math notranslate nohighlight">\(\frac{R_0 / \textit{infdur}}{\overline{k}}\)</span> infections occuring per contact.</p>
<ul class="simple">
<li><p>the Endo distribution determined as follows:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
\textit{Endo}(R_0, \omega)
\\\textit{where: }\omega \textit{ is the overdispersion parameter}
\end{equation}\end{split}\]</div>
<p>The Endo model is fairly complex so readers are encouraged to research it <a class="reference external" href="https://wellcomeopenresearch.org/articles/5-67#ref-12">here</a>. The paper determined an optimized value of <span class="math notranslate nohighlight">\(\omega\)</span> of <strong>0.1</strong> sars-cov-2, which will be used for our purposes.</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_17_0.png" src="_images/sizing_17_0.png" />
</div>
</div>
<p>We can see both environments do a good job of generating ~2.5 secondary infections, on average.</p>
<p>We also see that both have <span class="math notranslate nohighlight">\(R_0\)</span> distributions that fit the binomial distribution, not the Endo.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="Movement-Changes">
<h2>Movement Changes<a class="headerlink" href="#Movement-Changes" title="Permalink to this headline">¶</a></h2>
<p>We have seen the impact of density on the properties of the spread. Now we investigate the impact of movement patterns.</p>
<div class="section" id="Local-Bias">
<h3>Local Bias<a class="headerlink" href="#Local-Bias" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">local</span></code> patterns restrict the movement of a dot to only the nearest available locations. This is achieved using a geometric distribution with the <code class="docutils literal notranslate"><span class="pre">p</span></code> parameter governing the amount of restriction. The larger the <code class="docutils literal notranslate"><span class="pre">p</span></code>, the greater the restriction.</p>
<p>This is illustrated below:</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_21_0.png" src="_images/sizing_21_0.png" />
</div>
</div>
<p>There are <a class="reference internal" href="concepts.html#Mover-Functions"><span class="std std-ref">several pre-defined mover functions</span></a>, which can be utilized by providing a string or integer value to the <code class="docutils literal notranslate"><span class="pre">mover</span></code> attribute of a <code class="docutils literal notranslate"><span class="pre">Group</span></code>. The <code class="docutils literal notranslate"><span class="pre">local</span></code> mover function, for instance, utilizes a geometric distribution with p-value of 0.6.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">mover</span></code> attribute <em>also</em> accepts a float value, which is then provided as the specified p-value to a geometric distribution.</p>
<p>With this feature, we can generate simulations across a range of p-values.</p>
<p>Then, we can use the helper function <code class="docutils literal notranslate"><span class="pre">find_all_contacts</span></code> to generate a 2d array of the number of the contacts on each tick for every dot in each sim. Then multiply the contacts the transmission risk curve to get the <em>expected</em> <span class="math notranslate nohighlight">\(R_0\)</span> for every dot in the sim <em>as though they were infected initially</em>.</p>
<p>Repeat this for each <code class="docutils literal notranslate"><span class="pre">p-value</span></code>. Here, we cannot use <code class="docutils literal notranslate"><span class="pre">looper</span></code>, because the properties of each sim will change slightly, but we can use the <code class="docutils literal notranslate"><span class="pre">recycler</span></code> decorator to simplify the loop and pass existing <code class="docutils literal notranslate"><span class="pre">server</span></code> and <code class="docutils literal notranslate"><span class="pre">worker</span></code> actors if they are available.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rknot</span> <span class="kn">import</span> <span class="n">Sim</span>
<span class="kn">from</span> <span class="nn">rknot.sim</span> <span class="kn">import</span> <span class="n">recycler</span>
<span class="kn">from</span> <span class="nn">rknot.helpers</span> <span class="kn">import</span> <span class="n">find_all_contacts</span>

<span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">density</span><span class="o">=.</span><span class="mi">75</span><span class="p">,</span> <span class="n">R0</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">infdur</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">sterile</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">group</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">n_inf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ifr</span><span class="o">=</span><span class="mi">0</span><span class="p">,)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.96</span><span class="p">,</span> <span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>

<span class="n">dotlogs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;days&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">group</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">ML</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">all_contacts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">group</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;days&#39;</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">tmrs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;infdur&#39;</span><span class="p">]))</span>

<span class="n">sim_cycler</span> <span class="o">=</span> <span class="n">recycler</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">trange</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">group</span><span class="p">[</span><span class="s1">&#39;mover&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="n">sim_cycler</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="n">pbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="o">**</span><span class="n">params</span><span class="p">)</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">dotlog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dotlogs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">dotlog</span>
    <span class="n">all_contacts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbf</span><span class="o">.</span><span class="n">find_all_contacts</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dotlog</span><span class="p">,</span> <span class="n">MLNB</span><span class="p">)</span>
    <span class="n">tmrs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">tmrs</span>

<span class="n">contact_means</span> <span class="o">=</span> <span class="n">all_contacts</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;days&#39;</span><span class="p">]</span>
<span class="n">eR0s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">all_contacts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">eR0s</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">eR0_by_dot</span> <span class="o">=</span> <span class="n">tmrs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">all_contacts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">eR0_mu</span> <span class="o">=</span> <span class="n">eR0_by_dot</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">eR0s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">eR0_mu</span>
</pre></div>
</div>
<p>We can then chart <span class="math notranslate nohighlight">\(E(R_0)\)</span> against <code class="docutils literal notranslate"><span class="pre">p-value</span></code> to see the impact of restricting movement on spread.</p>
<p>Further, we show the change in mean contacts against <code class="docutils literal notranslate"><span class="pre">p-value</span></code> (which is a similar curve) and fit that curve to a 5-degree polynomial. This will be helpful in building <a class="reference external" href="#Complex-Environments">Complex Environments</a>.</p>
<p>We can also easily accomodate densities less than one by simply multiplying the polyfit parameters by the density.</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_26_0.png" src="_images/sizing_26_0.png" />
</div>
</div>
<p>We see that <span class="math notranslate nohighlight">\(R_0\)</span> has an inverse relationship to restricted movement (i.e. spread increases as populations become more well-mixed). This, of course, makes sense and is a fundamental premise of viral spread theory.</p>
<p><span class="math notranslate nohighlight">\(\underline{\text{However}}\)</span> what cannot be overlooked is how closely <span class="math notranslate nohighlight">\(R_0\)</span> in a <em>moderately</em> restricted environment resembles a completely well-mixed environment. And yet we know that the <code class="docutils literal notranslate"><span class="pre">local</span></code> <a class="reference internal" href="hit.html#2.-Local"><span class="std std-ref">mover function (with p-value of 0.6) results in a very different long-term spread curve</span></a>.</p>
<p>Further, each p-value results in normally-distributed contacts. We show this for a handful of p-values below.</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_29_0.png" src="_images/sizing_29_0.png" />
</div>
</div>
</div>
<div class="section" id="Interplay-of-Movement-and-Density">
<h3>Interplay of Movement and Density<a class="headerlink" href="#Interplay-of-Movement-and-Density" title="Permalink to this headline">¶</a></h3>
<p>We can also run each p-value against a range of densities.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">R0</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
    <span class="n">infdur</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
    <span class="n">days</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
    <span class="n">sterile</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">pbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">pbar_leave</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">reset_env</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">group</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
    <span class="n">n_inf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ifr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">densities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">75</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="n">dotlogs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span>
        <span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">densities</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;days&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">group</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">ML</span><span class="p">)</span>
    <span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span>
<span class="p">)</span>
<span class="n">all_contacts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span>
        <span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">densities</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">group</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;days&#39;</span><span class="p">]</span>
    <span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span>
<span class="p">)</span>
<span class="n">tmrs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">densities</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;infdur&#39;</span><span class="p">]))</span>

<span class="n">n_iters</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">densities</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">n_iters</span><span class="p">)</span>
<span class="n">sim_cycler</span> <span class="o">=</span> <span class="n">recycler</span><span class="p">(</span><span class="n">n_iters</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">group</span><span class="p">[</span><span class="s1">&#39;mover&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">densities</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">sim</span> <span class="o">=</span> <span class="n">sim_cycler</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">densities</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">dotlog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">dotlogs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">dotlog</span>
        <span class="n">all_contacts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">find_all_contacts</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dotlog</span><span class="p">,</span> <span class="n">MLNB</span><span class="p">)</span>
        <span class="n">tmrs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">tmrs</span>

        <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Then find the expected <span class="math notranslate nohighlight">\(R_0\)</span> for each combination:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">eR0s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">all_contacts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">all_contacts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">eR0s</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">eR0s</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">eR0_by_dot</span> <span class="o">=</span> <span class="n">tmrs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">all_contacts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">eR0_mu</span> <span class="o">=</span> <span class="n">eR0_by_dot</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">eR0s</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">eR0_mu</span>
</pre></div>
</div>
<p>And below we show <span class="math notranslate nohighlight">\(R_0\)</span>, contact <span class="math notranslate nohighlight">\(\mu\)</span>, and contact variance for a subset of the <code class="docutils literal notranslate"><span class="pre">p-value</span></code>/<code class="docutils literal notranslate"><span class="pre">density</span></code> combinations.</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\rho\)</span> = 0.5</p></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\rho\)</span> = 0.75</p></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\rho\)</span> = 1.0</p></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\rho\)</span> = 2.5</p></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\rho\)</span> = 5.0</p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>p-value</p></td>
<td><p><span class="math notranslate nohighlight">\(R_0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\overline{k}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\sigma^2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(R_0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\overline{k}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\sigma^2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(R_0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\overline{k}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\sigma^2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(R_0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\overline{k}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\sigma^2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(R_0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\overline{k}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\sigma^2\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>0.05</p></td>
<td><p>2.60</p></td>
<td><p>0.52</p></td>
<td><p>0.52</p></td>
<td><p>2.61</p></td>
<td><p>0.78</p></td>
<td><p>0.80</p></td>
<td><p>2.60</p></td>
<td><p>1.04</p></td>
<td><p>1.08</p></td>
<td><p>2.54</p></td>
<td><p>2.48</p></td>
<td><p>2.55</p></td>
<td><p>2.52</p></td>
<td><p>4.98</p></td>
<td><p>5.12</p></td>
</tr>
<tr class="row-even"><td><p>0.20</p></td>
<td><p>2.51</p></td>
<td><p>0.50</p></td>
<td><p>0.50</p></td>
<td><p>2.52</p></td>
<td><p>0.75</p></td>
<td><p>0.75</p></td>
<td><p>2.51</p></td>
<td><p>1.00</p></td>
<td><p>1.00</p></td>
<td><p>2.55</p></td>
<td><p>2.50</p></td>
<td><p>2.60</p></td>
<td><p>2.57</p></td>
<td><p>5.09</p></td>
<td><p>5.56</p></td>
</tr>
<tr class="row-odd"><td><p>0.35</p></td>
<td><p>2.45</p></td>
<td><p>0.49</p></td>
<td><p>0.49</p></td>
<td><p>2.48</p></td>
<td><p>0.74</p></td>
<td><p>0.73</p></td>
<td><p>2.48</p></td>
<td><p>0.99</p></td>
<td><p>1.01</p></td>
<td><p>2.52</p></td>
<td><p>2.46</p></td>
<td><p>2.46</p></td>
<td><p>2.53</p></td>
<td><p>5.00</p></td>
<td><p>5.20</p></td>
</tr>
<tr class="row-even"><td><p>0.50</p></td>
<td><p>2.41</p></td>
<td><p>0.48</p></td>
<td><p>0.48</p></td>
<td><p>2.41</p></td>
<td><p>0.72</p></td>
<td><p>0.70</p></td>
<td><p>2.43</p></td>
<td><p>0.97</p></td>
<td><p>0.96</p></td>
<td><p>2.50</p></td>
<td><p>2.44</p></td>
<td><p>2.41</p></td>
<td><p>2.51</p></td>
<td><p>4.96</p></td>
<td><p>4.99</p></td>
</tr>
<tr class="row-odd"><td><p>0.65</p></td>
<td><p>2.30</p></td>
<td><p>0.46</p></td>
<td><p>0.45</p></td>
<td><p>2.32</p></td>
<td><p>0.69</p></td>
<td><p>0.67</p></td>
<td><p>2.29</p></td>
<td><p>0.92</p></td>
<td><p>0.88</p></td>
<td><p>2.50</p></td>
<td><p>2.44</p></td>
<td><p>2.46</p></td>
<td><p>2.51</p></td>
<td><p>4.96</p></td>
<td><p>5.06</p></td>
</tr>
<tr class="row-even"><td><p>0.80</p></td>
<td><p>2.04</p></td>
<td><p>0.41</p></td>
<td><p>0.40</p></td>
<td><p>2.05</p></td>
<td><p>0.61</p></td>
<td><p>0.58</p></td>
<td><p>2.03</p></td>
<td><p>0.81</p></td>
<td><p>0.75</p></td>
<td><p>2.54</p></td>
<td><p>2.48</p></td>
<td><p>2.58</p></td>
<td><p>2.50</p></td>
<td><p>4.94</p></td>
<td><p>4.95</p></td>
</tr>
<tr class="row-odd"><td><p>0.95</p></td>
<td><p>1.17</p></td>
<td><p>0.23</p></td>
<td><p>0.22</p></td>
<td><p>1.14</p></td>
<td><p>0.34</p></td>
<td><p>0.33</p></td>
<td><p>1.17</p></td>
<td><p>0.47</p></td>
<td><p>0.43</p></td>
<td><p>2.50</p></td>
<td><p>2.44</p></td>
<td><p>2.45</p></td>
<td><p>2.48</p></td>
<td><p>4.90</p></td>
<td><p>4.66</p></td>
</tr>
<tr class="row-even"><td><p>0.98</p></td>
<td><p>0.64</p></td>
<td><p>0.13</p></td>
<td><p>0.12</p></td>
<td><p>0.60</p></td>
<td><p>0.18</p></td>
<td><p>0.17</p></td>
<td><p>0.61</p></td>
<td><p>0.25</p></td>
<td><p>0.23</p></td>
<td><p>2.49</p></td>
<td><p>2.43</p></td>
<td><p>2.40</p></td>
<td><p>2.47</p></td>
<td><p>4.89</p></td>
<td><p>4.74</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The table above has some interesting properties:</p>
<ol class="arabic simple">
<li><p>As expected, mean contacts, <span class="math notranslate nohighlight">\(\overline{k}\)</span>, increase with density.</p></li>
<li><p>Also, for densities of 1 or less, <span class="math notranslate nohighlight">\(\overline{k}\)</span> decrease with p-value.</p></li>
<li><p>Also, for densities of 1 or less, <span class="math notranslate nohighlight">\(R_0\)</span> decreases with density.</p></li>
</ol>
<p>HOWEVER, when density &gt; 1, all of the values remain almost constant for each density regardless of p-value. When a grid is overloaded with dots, by definition the same number of dots are expected at each location regardless of the movement pattern (on average).</p>
</div>
<div class="section" id="Location-Clustering">
<h3>Location Clustering<a class="headerlink" href="#Location-Clustering" title="Permalink to this headline">¶</a></h3>
<p>We should also mention the phenomena of dot clustering. We can determine how many different locations are occupied by at least one dot at each tick as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">unq_locs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">dotlogs</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dotlogs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dotlogs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dotlogs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
            <span class="n">unq_locs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">dotlogs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,:,</span><span class="n">ML</span><span class="p">[</span><span class="s1">&#39;loc_id&#39;</span><span class="p">]])</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>In the chart below, we can see that each sim with density &lt; 1, starts with dots occupying 10,000 unique locations (so each dot gets its own location), but over time dots cluster to a smaller number of locations.</p>
<p>The clustering appears asymptotic to a long-term value. That value appears to be inversely related to the density (so lower density means more locations and less clustering). And the speed at which that value is reached is related to the p-value.</p>
<p>For sims with density &gt; 1, there is no clustering.</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_40_0.png" src="_images/sizing_40_0.png" />
</div>
</div>
<p>Below we more clearly see the relationship between p-value and speed of clustering:</p>
<ol class="arabic simple">
<li><p>For density of 0.5:</p>
<ul class="simple">
<li><p>p-value is inversely related to clustering speed. i.e. movement patterns with higher p-values cluster slower</p></li>
</ul>
</li>
<li><p>For density of 5:</p>
<ul class="simple">
<li><p>there is no clustering and number of unique locations varies randomly in a tight range.</p></li>
</ul>
</li>
</ol>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_42_0.png" src="_images/sizing_42_0.png" />
</div>
</div>
</div>
<div class="section" id="R_0-Distribution">
<h3><span class="math notranslate nohighlight">\(R_0\)</span> Distribution<a class="headerlink" href="#R_0-Distribution" title="Permalink to this headline">¶</a></h3>
<p>For <span class="math notranslate nohighlight">\(R_0\)</span> distribution, we must loop through a large number of simulations. We will focus only on p-values [.25, .65, .95] and densities [.5, 1].</p>
<p>Again, we utilize the <code class="docutils literal notranslate"><span class="pre">looper</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rknot.helpers</span> <span class="kn">import</span> <span class="n">looper</span>

<span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">R0</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
    <span class="n">infdur</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
    <span class="n">days</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">group</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
    <span class="n">n_inf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ifr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">65</span><span class="p">,</span> <span class="o">.</span><span class="mi">95</span><span class="p">])</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">nsecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;days&#39;</span><span class="p">]))</span>
<span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">group</span><span class="p">[</span><span class="s1">&#39;mover&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">loop_nsecs</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">looper</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>

        <span class="n">nsecs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">loop_nsecs</span>

        <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we have a few findings:</p>
<ol class="arabic simple">
<li><p>There is one decent fit for the Endo model, which comes at the lowest density and the highest p-value.</p></li>
<li><p>The closest fit to the Binomial distribution comes at the highest <code class="docutils literal notranslate"><span class="pre">density=1</span></code> and the lowest p-value.</p></li>
</ol>
</div>
</div>
<hr class="docutils" />
<div class="section" id="Complex-Environments">
<h2>Complex Environments<a class="headerlink" href="#Complex-Environments" title="Permalink to this headline">¶</a></h2>
<p>We can use our findings to structure more complex environments that more appropriately mock real world interactions.</p>
<p>Here, we will incorporate a dynamic transmission curve with <span class="math notranslate nohighlight">\(R_0\)</span> dispersion that fits the <a class="reference external" href="https://wellcomeopenresearch.org/articles/5-67#ref-12">Endo model</a>.</p>
<p><span class="math notranslate nohighlight">\(\underline{\text{Hutch}}\)</span></p>
<p>As noted previously, with respect to sars-cov-2, the <a class="reference external" href="https://www.medrxiv.org/content/10.1101/2020.08.07.20169920v3.full.pdf">Hutch model</a> uses a <a class="reference external" href="https://en.wikipedia.org/wiki/Gamma_distribution">Gamma distribution</a> to govern real world interactions as per below:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
c_t\;\approx\;\Gamma(\alpha, \theta)\;\approx\;\Gamma(\frac{\overline{k}}{\theta}, \theta)
\\\alpha \textit{ is the shape parameter, }
\\\mu = \overline{k}, \textit{or the average daily contact rate }
\\\theta\textit{ is the dispersion parameter}
\end{equation}\end{split}\]</div>
<p>The scaling parameters are related to mean and variance as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
\\\overline{k} = \alpha\theta
\\\sigma^2 = \alpha\theta^2
\end{equation}\end{split}\]</div>
<p>The Hutch model combines this approach to contact distributions with a <a class="reference internal" href="theory.html#Dynamic-Transmission-Risk"><span class="std std-ref">model for dynamic viral load</span></a> to estimate contact level parameters for viral transmission.</p>
<p>They detail two sets of parameters for two <span class="math notranslate nohighlight">\(R_0\)</span> outcomes.</p>
<p><span class="math notranslate nohighlight">\(\underline{R_0 = 1.8}\)</span></p>
<ul class="simple">
<li><p>mean <span class="math notranslate nohighlight">\(R_0\)</span> of 1.8</p></li>
<li><p>4 mean contacts per day, <span class="math notranslate nohighlight">\(\overline{k}\)</span></p></li>
<li><p>40 dispersion, <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda\)</span> of 10**7 (a parameter influencing the relative infectiousness of an infected subjected)</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(\underline{R_0 = 2.8}\)</span></p>
<ul class="simple">
<li><p>mean <span class="math notranslate nohighlight">\(R_0\)</span> of 2.8</p></li>
<li><p>20 mean contacts per day, <span class="math notranslate nohighlight">\(\overline{k}\)</span></p></li>
<li><p>30 dispersion, <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda\)</span> of 10**7.5</p></li>
</ul>
<p>The parameter best fit for both outcomes was determined on a number of external inputs including adherence to the findings of the Endo model that &gt;70%+ primary infections caused no secondary infections.</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div class="admonition warning"><p class="admonition-title fa fa-exclamation-circle">Limitation</p><p>Currently, **RKnot** cannot replicate $R_0$ of 2.8 according to the above parameters as it cannot generate $\overline{k}=20$ according to the required Gamma distribution. This will be more viable when multiple ticks per day are available.</p></div></div>
</div>
<p><span class="math notranslate nohighlight">\(\underline{\text{Process}}\)</span></p>
<p>Our goal is to replicate both the Hutch model gamma distribution (both <span class="math notranslate nohighlight">\(\overline{k}\)</span> and <span class="math notranslate nohighlight">\(\theta\)</span>) and the Endo model <span class="math notranslate nohighlight">\(R_0\)</span> distribution.</p>
<p><strong>RKnot</strong> currently has 4 tools for increasing contact rate:</p>
<ul class="simple">
<li><p>changing density</p></li>
<li><p>changing movement patterns</p></li>
<li><p>events</p></li>
<li><p>vboxes</p></li>
</ul>
<p>We have seen that increasing density does increase <span class="math notranslate nohighlight">\(\overline{k}\)</span>, but that both contacts and <span class="math notranslate nohighlight">\(R_0\)</span> are normally/binomially distributed. So increasing density is not appropriate.</p>
<p>We have also seen that changing movement patterns only has an impact where density &lt; 1 and can only increase it up to the density. So, if our density must be &lt;= 1, our movement pattern can only ever increase density to &lt;= 1.</p>
<p>So we are left with events and vboxes.</p>
<p>Thus, our process for building complex environments is as follows:</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div class="admonition note"><p class="admonition-title fa fa-exclamation-circle">Process</p><p></p>
    <ol>
        <li>Identify required contact distribution based on Hutch parameters.</li>
        <li>Identify contact distribution to result from events.</li>
        <li>Determine the number of events required for each capacity to replicate the curve from 2) above.</li>
        <li>Determine the density of the remaining dots not in the vbox and find mover function that helps replicate the required contact distribution at the lower contact levels.</li>
        <li>Set the vbox location size based on maximum number of events per day.</li>
    </ol>
</div></div>
</div>
<div class="section" id="Hutch-Model:-R_0-of-1.8">
<h3>Hutch Model: <span class="math notranslate nohighlight">\(R_0\)</span> of 1.8<a class="headerlink" href="#Hutch-Model:-R_0-of-1.8" title="Permalink to this headline">¶</a></h3>
<p>We will demonstrate the building of a complex environment using <span class="math notranslate nohighlight">\(R_0\)</span> 1.8 Hutch model.</p>
<p>Our environment will have with following initial conditions:</p>
<ul class="simple">
<li><p>Population of 10,000</p></li>
<li><p>Initial infected of 1</p></li>
<li><p>Density of 1</p></li>
<li><p>Length of 30 days</p></li>
<li><p>0.98 p-value for mover</p></li>
</ul>
<p>Our model targets: + <span class="math notranslate nohighlight">\(R_0 = 1.8\)</span> + <span class="math notranslate nohighlight">\(\overline{k} = 4\)</span> + <span class="math notranslate nohighlight">\(\theta = 40\)</span></p>
<p><span class="math notranslate nohighlight">\(\underline{\text{Exploring the Contact Distribution}}\)</span></p>
<p>We can visualize the expected contact rate distribution by generating a random set of contacts on the gamma distribution.</p>
<p>We know that there should be <span class="math notranslate nohighlight">\(n_{dots}\)</span> * <span class="math notranslate nohighlight">\(n_{days}\)</span> number of records of contacts (300,000) and so can show the number of occurences of each amount of contacts from a gamma sample:</p>
<p>The initial parameters are as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">days</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">size</span> <span class="o">=</span> <span class="n">n</span><span class="o">*</span><span class="n">days</span>
<span class="n">density</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">gloc</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">sim_tmr</span> <span class="o">=</span> <span class="n">tmr</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">theta</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">tgt_R0</span> <span class="o">=</span> <span class="mf">1.8</span>
</pre></div>
</div>
</div>
<p>From these, we can generate a sample gamma distribution as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">alpha</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">/</span> <span class="n">theta</span>
<span class="n">k_gam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">k_gam</span></code> can be passed to a histogram and results in the folllowing:</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_61_0.png" src="_images/sizing_61_0.png" />
</div>
</div>
<p>By far, most dot-days must have 0 contacts. Above we zoomed in on the first 10 contact levels to give a sense for the most pertinent values.</p>
<p>Below we show the distribution tail. Remember that while the number of occurences is relatively low, given the contact level is so high they still produce a large number of contacts.</p>
<p>For instance:</p>
<ul class="simple">
<li><p>2,000 dot-days of 2 contacts produces 4,000 contacts</p></li>
<li><p>40 dot-days of 100 contacts produces 40,000 contacts</p></li>
</ul>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_63_0.png" src="_images/sizing_63_0.png" />
</div>
</div>
<p>From the distribution above, we can focus on the contacts that must be event-driven. For our sim, we have chosen contacts of 2 or more (equal to event apacity of 3) to result from events.</p>
<p>Thus, events must replicate the distribution below, which is still a gamma distribution, slightly modified from the original.</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_65_0.png" src="_images/sizing_65_0.png" />
</div>
</div>
<p><span class="math notranslate nohighlight">\(\underline{\text{Creating Events}}\)</span></p>
<p>The number of contacts for a single dot at an event is simply the capacity minus 1, since a dot cannot contact itself.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
k_e = \text{cap}_e - 1
\\\textit{where: } k_e \textit{ = contact level for event e}
\\\textit{cap}_e \textit{ = capacity for event e}
\end{equation}\end{split}\]</div>
<p>Multiplying again for every dot at the event gives us the total contacts for all dots:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
c_e\;=\;(cap_e - 1)*cap_e
\\\textit{where: } c_e \textit{ = total contacts for event e}
\end{equation}\end{split}\]</div>
<p>Remember that our target <span class="math notranslate nohighlight">\(\overline{k}\)</span> is the average contact rate <em>per dot</em>, so the number of events should be structured on a per dot basis. The number of events required for a particular contact level, <span class="math notranslate nohighlight">\(k\)</span>, then, is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
n_{e,j} = \frac{k_{tgt,i}}{cap_{e,j}}
\\\textit{i = contact level}
\\\textit{j = i + 1 = event capacity}
\end{equation}\end{split}\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">c_eve</span> <span class="o">=</span> <span class="n">c_eve</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">caps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">c_eve</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span>

<span class="n">n_events</span> <span class="o">=</span> <span class="n">c_eve</span><span class="p">[</span><span class="n">gloc</span><span class="p">:]</span> <span class="o">/</span> <span class="n">caps</span><span class="p">[</span><span class="n">gloc</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<p><strong>RKnot’s</strong> ability to replicate the Gamma distribution fails on the long tail of the distribution when the number of occurences of a specified contact level is fewer than the contacts that would be generated by a single event.</p>
<p>For instance, the Hutch gamma distribution results in ~40 dot-days with 100 contacts. <strong>RKnot</strong> can only generate 100 contacts through a 100 contact event and a 100 contact event generates <span class="math notranslate nohighlight">\((100-1)*100 = 9,900\)</span> contacts, far more than required.</p>
<p>Our current hack-fix is to regroup and redistribute all contact occurences above that threshold into events. This results in a tail that is less evenly distributed.</p>
<p>A better solution would be to increase the number of ticks per day, which would allow for many more independent streams of contact distributions among dots. This feature will be available in future versions.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">i_events</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">n_events</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="n">i_large</span> <span class="o">=</span> <span class="n">i_events</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">k_to_replicate</span> <span class="o">=</span> <span class="n">n_events</span><span class="p">[</span><span class="n">i_large</span><span class="p">:]</span><span class="o">*</span><span class="n">caps</span><span class="p">[</span><span class="n">gloc</span> <span class="o">+</span> <span class="n">i_large</span><span class="p">:]</span><span class="o">*</span><span class="n">caps</span><span class="p">[</span><span class="n">gloc</span> <span class="o">+</span> <span class="n">i_large</span><span class="p">:]</span>

<span class="n">total</span> <span class="o">=</span> <span class="n">k_to_replicate</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">skip</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">add_caps</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">cap</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i_large</span> <span class="o">+</span> <span class="n">skip</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i_large</span> <span class="o">+</span> <span class="n">k_to_replicate</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">skip</span><span class="p">):</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">total</span> <span class="o">-</span> <span class="p">((</span><span class="n">cap</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cap</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">total</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">add_caps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cap</span><span class="p">)</span>
        <span class="n">n_events</span><span class="p">[</span><span class="n">cap</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">n_events</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">n_events</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_events</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>With the number of events for each capacity determined, we can assign event objects.</p>
<p>To do so, we:</p>
<ul class="simple">
<li><p>utilize the <a class="reference internal" href="hit.html"><span class="doc">“baseus” groups used in the SIR analysis</span></a>.</p></li>
<li><p>assign a p-value of .98 to the mover function of group.</p>
<ul>
<li><p><em>determined through a trial and error process that best fit the Hutch distribution.</em></p></li>
</ul>
</li>
<li><p>randomly assign each event a start tick between 1 and 30, which is the length of the simulation.</p></li>
<li><p>assign each event to <code class="docutils literal notranslate"><span class="pre">vbox=0</span></code></p></li>
<li><p>as all events will occur inside a vbox, a <code class="docutils literal notranslate"><span class="pre">Travel</span></code> event must be used to transport them to the event location.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rknot.sims</span> <span class="kn">import</span> <span class="n">baseus</span>
<span class="kn">from</span> <span class="nn">rknot.events</span> <span class="kn">import</span> <span class="n">Travel</span>

<span class="n">groups</span> <span class="o">=</span> <span class="n">baseus</span><span class="o">.</span><span class="n">groups</span>
<span class="n">groups</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;n_inf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
    <span class="n">group</span><span class="p">[</span><span class="s1">&#39;mover&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">98</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;days&#39;</span><span class="p">:</span> <span class="n">days</span><span class="p">,</span> <span class="s1">&#39;tmr_curve&#39;</span><span class="p">:</span> <span class="n">sim_tmr</span><span class="p">,</span> <span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="n">density</span><span class="p">,</span> <span class="s1">&#39;sterile&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>

<span class="n">event_groups</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_events</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">n_events</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">event_group</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="n">gloc</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">n&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="n">n_events</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;groups&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;capacity&#39;</span><span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="n">gloc</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span>
        <span class="n">event_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event_group</span><span class="p">)</span>

<span class="n">events</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">event_groups</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]):</span>
        <span class="n">start_tick</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
        <span class="n">events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Travel</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">j</span><span class="p">),</span> <span class="n">start_tick</span><span class="o">=</span><span class="n">start_tick</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">groups</span><span class="o">=</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;groups&#39;</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;capacity&#39;</span><span class="p">],</span> <span class="n">vbox</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="p">)</span>
</pre></div>
</div>
<p>In the chart below, we can see the distribution of the capacity of the events generated by this process over the life of the simulation.</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_74_0.png" src="_images/sizing_74_0.png" />
</div>
</div>
<p>So, for the length of the simulation between 18 to 26% of the population will be attending events <em>each day of the simulation</em>.</p>
<p>Below, we can see that for the lower contact levels, this approach generates a near perfect replica of the required Gamma distribution.</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_76_0.png" src="_images/sizing_76_0.png" />
</div>
</div>
<p>When we focus on contact levels of 100+, however, you can see that we only generate contacts at 3 levels.</p>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-86-7045da940dac&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-green-fg">with</span> np<span class="ansi-blue-fg">.</span>errstate<span class="ansi-blue-fg">(</span>divide<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;ignore&#39;</span><span class="ansi-blue-fg">,</span> invalid<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;ignore&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg">     </span>ktrbar<span class="ansi-blue-fg">(</span>contacts<span class="ansi-blue-fg">,</span> c_eve<span class="ansi-blue-fg">,</span> xlim<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">100</span><span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">300</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> ylim<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">300</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> plt<span class="ansi-blue-fg">.</span>show<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/Documents/programming/rknot/rknot/notebook/visuals.py</span> in <span class="ansi-cyan-fg">ktrbar</span><span class="ansi-blue-fg">(contacts, c_eve, ax, title, title_y, xlim, ylim, figsize)</span>
<span class="ansi-green-intense-fg ansi-bold">    356</span>     x <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>arange<span class="ansi-blue-fg">(</span>contacts<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    357</span>     alpha <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">.5</span> <span class="ansi-green-fg">if</span> c_eve <span class="ansi-blue-fg">!=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">else</span> <span class="ansi-cyan-fg">1</span>
<span class="ansi-green-fg">--&gt; 358</span><span class="ansi-red-fg">     </span>ax<span class="ansi-blue-fg">.</span>bar<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">+</span><span class="ansi-cyan-fg">.5</span><span class="ansi-blue-fg">,</span> contacts<span class="ansi-blue-fg">,</span> alpha<span class="ansi-blue-fg">=</span>alpha<span class="ansi-blue-fg">,</span> width<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">.9</span><span class="ansi-blue-fg">,</span> label<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;Events&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    359</span>
<span class="ansi-green-intense-fg ansi-bold">    360</span>     <span class="ansi-green-fg">if</span> c_eve <span class="ansi-blue-fg">!=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/Documents/programming/envs/r0env/lib/python3.8/site-packages/matplotlib/__init__.py</span> in <span class="ansi-cyan-fg">inner</span><span class="ansi-blue-fg">(ax, data, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1436</span>     <span class="ansi-green-fg">def</span> inner<span class="ansi-blue-fg">(</span>ax<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> data<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1437</span>         <span class="ansi-green-fg">if</span> data <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1438</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> func<span class="ansi-blue-fg">(</span>ax<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>map<span class="ansi-blue-fg">(</span>sanitize_sequence<span class="ansi-blue-fg">,</span> args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1439</span>
<span class="ansi-green-intense-fg ansi-bold">   1440</span>         bound <span class="ansi-blue-fg">=</span> new_sig<span class="ansi-blue-fg">.</span>bind<span class="ansi-blue-fg">(</span>ax<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/Documents/programming/envs/r0env/lib/python3.8/site-packages/matplotlib/axes/_axes.py</span> in <span class="ansi-cyan-fg">bar</span><span class="ansi-blue-fg">(self, x, height, width, bottom, align, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   2428</span>                 yerr <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_convert_dx<span class="ansi-blue-fg">(</span>yerr<span class="ansi-blue-fg">,</span> y0<span class="ansi-blue-fg">,</span> y<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>convert_yunits<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2429</span>
<span class="ansi-green-fg">-&gt; 2430</span><span class="ansi-red-fg">         x, height, width, y, linewidth = np.broadcast_arrays(
</span><span class="ansi-green-intense-fg ansi-bold">   2431</span>             <span class="ansi-red-fg"># Make args iterable too.</span>
<span class="ansi-green-intense-fg ansi-bold">   2432</span>             np.atleast_1d(x), height, width, y, linewidth)

<span class="ansi-green-fg">&lt;__array_function__ internals&gt;</span> in <span class="ansi-cyan-fg">broadcast_arrays</span><span class="ansi-blue-fg">(*args, **kwargs)</span>

<span class="ansi-green-fg">~/Documents/programming/envs/r0env/lib/python3.8/site-packages/numpy/lib/stride_tricks.py</span> in <span class="ansi-cyan-fg">broadcast_arrays</span><span class="ansi-blue-fg">(subok, *args)</span>
<span class="ansi-green-intense-fg ansi-bold">    256</span>     args <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>np<span class="ansi-blue-fg">.</span>array<span class="ansi-blue-fg">(</span>_m<span class="ansi-blue-fg">,</span> copy<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> subok<span class="ansi-blue-fg">=</span>subok<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> _m <span class="ansi-green-fg">in</span> args<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    257</span>
<span class="ansi-green-fg">--&gt; 258</span><span class="ansi-red-fg">     </span>shape <span class="ansi-blue-fg">=</span> _broadcast_shape<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    259</span>
<span class="ansi-green-intense-fg ansi-bold">    260</span>     <span class="ansi-green-fg">if</span> all<span class="ansi-blue-fg">(</span>array<span class="ansi-blue-fg">.</span>shape <span class="ansi-blue-fg">==</span> shape <span class="ansi-green-fg">for</span> array <span class="ansi-green-fg">in</span> args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/Documents/programming/envs/r0env/lib/python3.8/site-packages/numpy/lib/stride_tricks.py</span> in <span class="ansi-cyan-fg">_broadcast_shape</span><span class="ansi-blue-fg">(*args)</span>
<span class="ansi-green-intense-fg ansi-bold">    187</span>     <span class="ansi-red-fg"># use the old-iterator because np.nditer does not handle size 0 arrays</span>
<span class="ansi-green-intense-fg ansi-bold">    188</span>     <span class="ansi-red-fg"># consistently</span>
<span class="ansi-green-fg">--&gt; 189</span><span class="ansi-red-fg">     </span>b <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>broadcast<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span><span class="ansi-cyan-fg">32</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    190</span>     <span class="ansi-red-fg"># unfortunately, it cannot handle 32 or more arguments directly</span>
<span class="ansi-green-intense-fg ansi-bold">    191</span>     <span class="ansi-green-fg">for</span> pos <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">32</span><span class="ansi-blue-fg">,</span> len<span class="ansi-blue-fg">(</span>args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">31</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">ValueError</span>: shape mismatch: objects cannot be broadcast to a single shape
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_78_1.png" src="_images/sizing_78_1.png" />
</div>
</div>
<p><span class="math notranslate nohighlight">\(\underline{\text{Forming the Remaining Environment}}\)</span></p>
<p>With contact levels 2+ settled, we must set the non-event environment such that it generates mainly 0 contacts.</p>
<p>First, we find the average density of the grid (excluding the vbox) during the sim. Only dots not attending events will be in the main grid, so density is as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">n_dots_at_events</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">n_dots_not_events</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">n_dots_at_events</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">n_dots_not_events</span> <span class="o">/</span> <span class="n">n</span> <span class="c1"># given density of 1</span>

<span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.78
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<p>The density of the grid excluding dots on events will be 0.78.So we can find the expected <span class="math notranslate nohighlight">\(\overline{k}\)</span> of that space using the <a class="reference external" href="#Movement-Changes">polyfit equation we found above</a> to find the corresponding variance and providing the <code class="docutils literal notranslate"><span class="pre">p-value</span></code> for group movement. And then apply <span class="math notranslate nohighlight">\(\overline{k}\)</span> to a normal distribution to find the expected contacts for the non-event space.</p>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
<span class="n">mu_space</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">.</span><span class="mi">98</span><span class="p">)</span>
<span class="n">var_space</span> <span class="o">=</span> <span class="n">mu_space</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">c_non</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_space</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var_space</span><span class="p">))</span>
<span class="n">c_non</span> <span class="o">=</span> <span class="n">d</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="mi">30</span><span class="o">*</span><span class="n">c_non</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_84_0.png" src="_images/sizing_84_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;And so the expect 0 contacts occurences are right in line with the target: &#39;</span>
<span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1"> </span><span class="si">{</span><span class="n">c_non</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1"> vs. </span><span class="si">{</span><span class="n">c_gam</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">As are the 1 contact occurences: &#39;</span>
<span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1"> </span><span class="si">{</span><span class="n">c_non</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1"> vs. </span><span class="si">{</span><span class="n">c_gam</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1">&#39;</span>

<span class="n">md</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<p>And so the expect 0 contacts occurences are right in line with the target:</p>
<p>228,464 vs. 217,387</p>
<p>As are the 1 contact occurences:</p>
<p>20,230 vs. 15,243</p>
</div>
</div>
<p>Thus, we expect the non-event space will result in 200,000+ dot days with no contacts, right in line with Hutch gamma.</p>
<p>The final step in preparing the simulation environment is determing the size of the VBox. The chart below shows the number of events occuring on each tick in the Sim.</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_87_0.png" src="_images/sizing_87_0.png" />
</div>
</div>
<p>Above we can see that there are typically ~300 events occuring on a given tick.</p>
<p>The vbox must allow for each event to have its own location, so the vbox should have enough locations to support the maximum number of events occuring on the same tick, which is:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">start_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">e</span><span class="o">.</span><span class="n">start_tick</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">events</span><span class="p">])</span>
<span class="n">n_events_by_tick</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">start_ticks</span><span class="p">)</span>
<span class="n">n_events_by_tick</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
344
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<p>The vbox must have 344 locations.</p>
</div>
</div>
<p><span class="math notranslate nohighlight">\(\underline{\text{Run the Sim}}\)</span></p>
<p>We will run a single Sim to use for <code class="docutils literal notranslate"><span class="pre">all_contacts</span></code> comparison:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vbox</span> <span class="o">=</span> <span class="n">n_events_by_tick</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events</span><span class="p">,</span> <span class="n">vboxes</span><span class="o">=</span><span class="n">vbox</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">dotlog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">all_contacts</span> <span class="o">=</span> <span class="n">find_all_contacts</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dotlog</span><span class="p">,</span> <span class="n">MLNB</span><span class="p">)</span>
<span class="n">eR0_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">all_contacts</span><span class="p">[:,:</span><span class="n">sim_tmr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">*</span><span class="n">sim_tmr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
<p>We can see from the outputs that the sim produces fairly similar outcomes to those desired.</p>
<p><span class="math notranslate nohighlight">\(\underline{\text{Results}}\)</span></p>
<p>The sim reproduced <span class="math notranslate nohighlight">\(R_0\)</span> as desired, however, contact rate is slightly below target and theta slightly over. This is likely the result of the long-tail issues described earlier.</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<table>
    <thead>
        <tr>
            <th class="results-table">$R_0$</th>
            <th class="results-table">$\overline{{k}}$</th>
            <th class="results-table">$\theta$</th>
        </tr>
    </thead>

    <tbody>
        <tr>
            <td class="results-table">1.82</td>
            <td class="results-table">3.36</td>
            <td class="results-table">54.56</td>
        </tr>
    </tbody>
</table></div>
</div>
<p>And the contact distribution visually fits the desired Gamma almost perfectly.</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_98_0.png" src="_images/sizing_98_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_99_0.png" src="_images/sizing_99_0.png" />
</div>
</div>
<p>And that the expected <span class="math notranslate nohighlight">\(R_0\)</span> distribtion is a much stronger fit for the Endo model (although still underweight slightly to 0 infection outcomes).</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_101_0.png" src="_images/sizing_101_0.png" />
</div>
</div>
<p><span class="math notranslate nohighlight">\(\underline{\text{Run a Larger Dataset}}\)</span></p>
<p>The <code class="docutils literal notranslate"><span class="pre">all_contacts</span></code> method is good way to get a quick read on the viability of an environment, however, it is still only a rough estimate. Truly reliable statistics can only come from running the simulation many times.</p>
<p>We will loop through 1,000 sims:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">contacts</span><span class="p">,</span> <span class="n">nsecs</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">exceptions</span> <span class="o">=</span> <span class="n">looper</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;days&#39;</span><span class="p">],</span> <span class="n">tmr</span><span class="o">=</span><span class="n">sim_tmr</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events</span><span class="p">,</span> <span class="n">vboxes</span><span class="o">=</span><span class="n">vbox</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(\underline{\text{Results}}\)</span></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[77]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eR0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">contacts</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">sim_tmr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">sim_tmr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">R0</span> <span class="o">=</span> <span class="n">nsecs</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<table>
    <thead>
        <tr>
            <th class="results-table">E($R_0$)</th>
            <th class="results-table">$R_0$</th>
            <th class="results-table">$\overline{{k}}$</th>
            <th class="results-table">$\theta$</th>
        </tr>
    </thead>

    <tbody>
        <tr>
            <td class="results-table">1.78</td>
            <td class="results-table">1.72</td>
            <td class="results-table">3.34</td>
            <td class="results-table">59.72</td>
        </tr>
    </tbody>
</table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_108_0.png" src="_images/sizing_108_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_109_0.png" src="_images/sizing_109_0.png" />
</div>
</div>
<p>The above iterations set <code class="docutils literal notranslate"><span class="pre">sterile=True</span></code>, in order to isolate the contacts and secondary infections of <em>just the initial infected</em>.</p>
<p>We can learn more about the outcomes in the simulation by again using <code class="docutils literal notranslate"><span class="pre">looper</span></code> and setting <code class="docutils literal notranslate"><span class="pre">sterile=False</span></code>, <code class="docutils literal notranslate"><span class="pre">days=365</span></code>. We will complete just 250 iterations, because each sim will run longer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">250</span>
<span class="n">days</span> <span class="o">=</span> <span class="mi">365</span>
<span class="n">contacts</span><span class="p">,</span> <span class="n">nsecs</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">exceptions</span> <span class="o">=</span> <span class="n">looper</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">tmr</span><span class="o">=</span><span class="n">sim_tmr</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events</span><span class="p">,</span> <span class="n">vboxes</span><span class="o">=</span><span class="n">vbox</span><span class="p">,</span> <span class="n">sterile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<table class="results-table"><thead><tr><th class="results-table"></th><th class="results-table" style="text-align: center;">1 Infection</th><th class="results-table" style="text-align: center;">2 Infections</th><th class="results-table" style="text-align: center;">1 Infection<br>$R_0$ > 0</th><th class="results-table" style="text-align: center;">2 Infections<br>$R_0$ > 0</th></tr></thead><tbody><tr><td class="results-table" style="text-align: left;">Peak</td><td class="results-table" style="text-align: center;">3.8%</td><td class="results-table" style="text-align: center;">8.9%</td><td class="results-table" style="text-align: center;">34.5%</td><td class="results-table" style="text-align: center;">33.1%</td></tr><tr><td class="results-table" style="text-align: left;">HIT</td><td class="results-table" style="text-align: center;">4.6%</td><td class="results-table" style="text-align: center;">11.1%</td><td class="results-table" style="text-align: center;">42.3%</td><td class="results-table" style="text-align: center;">41.1%</td></tr><tr><td class="results-table" style="text-align: left;">Total</td><td class="results-table" style="text-align: center;">5.9%</td><td class="results-table" style="text-align: center;">14.0%</td><td class="results-table" style="text-align: center;">53.8%</td><td class="results-table" style="text-align: center;">52.3%</td></tr><tr><td class="results-table" style="text-align: left;">Days to Peak</td><td class="results-table" style="text-align: center;">11</td><td class="results-table" style="text-align: center;">24</td><td class="results-table" style="text-align: center;">28</td><td class="results-table" style="text-align: center;">38</td></tr></tbody></table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_115_0.png" src="_images/sizing_115_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/sizing_116_0.png" src="_images/sizing_116_0.png" />
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="hit.html" class="btn btn-neutral float-right" title="SIR: Factors Influencing Spread" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="concepts.html" class="btn btn-neutral float-left" title="Key Concepts" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, rskene

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>