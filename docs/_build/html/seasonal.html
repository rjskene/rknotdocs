

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Seasonality &mdash; RKnot  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}}, "tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Multiple Jurisdictions" href="multi.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> RKnot
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
</ul>
<p class="caption"><span class="caption-text">ARCHITECTURE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="theory.html">Viral Spread Theory in RKnot</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Key Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="sizing.html">Sizing</a></li>
</ul>
<p class="caption"><span class="caption-text">SIMULATIONS</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="hit.html">SIR: Factors Influencing Spread</a></li>
<li class="toctree-l1"><a class="reference internal" href="load.html">Dynamic Transmission Risk</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi.html">Multiple Jurisdictions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Seasonality</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#SIR">SIR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Events">Events</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">RKnot</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Seasonality</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/seasonal.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<hr class="docutils" />
<div class="section" id="Seasonality">
<h1>Seasonality<a class="headerlink" href="#Seasonality" title="Permalink to this headline">¶</a></h1>
<p>There are many viruses that exhibit seasonality. In particular, in (northern??) North America, influenza and the common cold (<a class="reference external" href="https://en.wikipedia.org/wiki/Common_cold">which is a catch-all for a collection of ~different virus strains</a>) predictably peak in the winter months and subside in the summer. The reasons for the seasonality of these viruses (and not others) is still somewhat of a mystery, but <a class="reference external" href="https://ccdd.hsph.harvard.edu/will-covid-19-go-away-on-its-own-in-warmer-weather">the Harvard School Public Health provides a summary of potential factors
here</a>.</p>
<p><strong>Natural Progression of Immunity</strong></p>
<ul class="simple">
<li><p>remarkably, the most relevant factor may have nothing at all to do with seasonality. A virus and its host population may have an immunity profile that results in an intrinsic ebb and flow of infections (that may or may not line up with typical regional seasons). For instance, <a class="reference external" href="https://www.cdc.gov/flu/professionals/acip/immunogenicity.htm#Duration">influenza immunity is believed to last for 3 months</a>, meaning that the potential host population subsides and then increases in time for the
virus to reemerge months later (to say nothing of the different types of influenza that might be prevalent during any season).</p></li>
</ul>
<p><strong>Geological / Meteorological Factors</strong></p>
<ul class="simple">
<li><p>Lower humidity has been shown to slow influenza spread although very high humditiy has been shown to increase it in tropical regions.</p></li>
<li><p><a class="reference external" href="https://ehp.niehs.nih.gov/doi/pdf/10.1289/ehp.1002383">Sun exposure and temperature have also been shown to impact influenza prevalence</a>.</p></li>
</ul>
<p><strong>Behavior Changes</strong></p>
<ul class="simple">
<li><p>In colder environments, people tend to move indoors more frequently in closer quarters and with worse ventalition. In particular, school seasonality in North America aligns with winter.</p></li>
<li><p>one should also consider that the <em>warmest</em> environments might experience inverse behavior changes to the coldest. People in the southern US, for example, may move indoors during the peak of summer to take advantage of air conditioning (<a class="reference external" href="https://twitter.com/NateSilver538/status/1273329472524222466">this was suggested by Nate Silver of FiveThirtyEight</a>).</p></li>
</ul>
<p><strong>Weakening Immune System</strong></p>
<ul class="simple">
<li><p>there is limited research but it is also known that melatonin and vitamin D play a role in immune response. So individuals with less exposure to sunshine (whether due to covering up when outdoors or simply being indoors) may result in a greater number of infections.</p></li>
</ul>
<p><a class="reference external" href="https://ccdd.hsph.harvard.edu/will-covid-19-go-away-on-its-own-in-warmer-weather">Professor Lipsitch of Harvard</a> is also very careful to emphasize that seasonal factors are likely much more relevant in <em>existing</em> viruses versus <em>new</em> viruses. The sheer size of the susceptible population of a new virus is likely enough to overwhelm the marginal impact of any one or all seasonal factors combined.</p>
<p>That said, even with new viruses, one would expect these factors to provide at least <em>some</em> resistance or reinforcement as they case may be.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">rknot</span> <span class="kn">import</span> <span class="n">Sim</span><span class="p">,</span> <span class="n">Chart</span>
<span class="kn">from</span> <span class="nn">rknot.parallel.env</span> <span class="kn">import</span> <span class="n">Environment</span> <span class="k">as</span> <span class="n">Env</span>
<span class="kn">from</span> <span class="nn">rknot.space</span> <span class="kn">import</span> <span class="n">create_matrix</span>


<span class="n">group</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;n_inf&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;box_is_gated&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;boxf&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">}</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="mf">1.8</span><span class="p">,</span><span class="s1">&#39;imndur&#39;</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="s1">&#39;infdur&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;days&#39;</span><span class="p">:</span> <span class="mi">150</span><span class="p">}</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">Env</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">group</span><span class="p">],</span> <span class="p">[],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;imndur&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;R0&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;infdur&#39;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span>
<span class="n">env</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>

<span class="n">locmat</span><span class="p">,</span> <span class="n">loc_tmf</span> <span class="o">=</span> <span class="n">create_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;days&#39;</span><span class="p">],</span> <span class="n">env</span><span class="o">.</span><span class="n">boxes</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">gates</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<p>This results in the matrix below, with shape (100, 150). You can see that each location (rows) has the same transmission factor on each tick (columns).</p>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">loc_tmf</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[200, 200, 200, ..., 200, 200, 200],
       [200, 200, 200, ..., 200, 200, 200],
       [200, 200, 200, ..., 200, 200, 200],
       ...,
       [200, 200, 200, ..., 200, 200, 200],
       [200, 200, 200, ..., 200, 200, 200],
       [200, 200, 200, ..., 200, 200, 200]], dtype=int32)
</pre></div></div>
</div>
<p>Location transmission factors can take on any shape the user desires. In the example below, a series of cosine waves are used to create a single curve with following attributes:</p>
<ul class="simple">
<li><p>season lasting 365 days</p></li>
<li><p>seasonal variability factor of 2x (lower variability factor leads to greater variability)</p></li>
<li><p>peak transmission factor occurs in the beginning</p></li>
<li><p>trough transmission factor occurs at the midpoint</p></li>
</ul>
<p>This is meant as a rough approximation of seasonal factors impacting viral spread when spread begins in the middle of winter.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">seasonal_range</span> <span class="o">=</span> <span class="mi">365</span>
<span class="n">seasonal_factor</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">seasonal_range</span><span class="p">)</span>
<span class="n">base</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">s1</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">48</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="n">mixed</span> <span class="o">=</span> <span class="n">base</span> <span class="o">+</span> <span class="n">s1</span> <span class="o">+</span> <span class="n">s2</span>
<span class="n">tmf</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">mixed</span> <span class="o">/</span> <span class="n">seasonal_factor</span>
<span class="n">tmf</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">tmf</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The code above results in the following:</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/seasonal_9_0.png" src="_images/seasonal_9_0.png" />
</div>
</div>
<p>And shown in the <code class="docutils literal notranslate"><span class="pre">tmf</span></code> array below:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tmf</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142,
       142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142,
       142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 141, 141,
       141, 141, 141, 141, 141, 140, 140, 140, 140, 139, 139, 139, 138,
       138, 138, 137, 137, 136, 136, 135, 134, 134, 133, 132, 132, 131,
       130, 129, 128, 128, 127, 126, 125, 124, 123, 121, 120, 119, 118,
       117, 116, 114, 113, 112, 110, 109, 108, 106, 105, 104, 102, 101,
       100,  98,  97,  95,  94,  93,  91,  90,  89,  87,  86,  85,  83,
        82,  81,  80,  79,  78,  76,  75,  74,  73,  72,  71,  71,  70,
        69,  68,  67,  67,  66,  65,  65,  64,  63,  63,  62,  62,  61,
        61,  61,  60,  60,  60,  59,  59,  59,  59,  58,  58,  58,  58,
        58,  58,  58,  57,  57,  57,  57,  57,  57,  57,  57,  57,  57,
        57,  57,  57,  57,  57,  57,  57,  57,  57,  57,  57,  57,  57,
        57,  57,  57,  57,  57,  57,  57,  57,  57,  57,  57,  57,  57,
        57,  57,  57,  57,  57,  57,  57,  57,  57,  57,  57,  57,  57,
        57,  57,  57,  57,  57,  57,  57,  57,  57,  57,  57,  57,  57,
        57,  57,  57,  57,  57,  57,  57,  57,  57,  57,  57,  58,  58,
        58,  58,  58,  58,  58,  59,  59,  59,  59,  60,  60,  60,  61,
        61,  61,  62,  62,  63,  63,  64,  65,  65,  66,  67,  67,  68,
        69,  70,  71,  71,  72,  73,  74,  75,  76,  78,  79,  80,  81,
        82,  83,  85,  86,  87,  89,  90,  91,  93,  94,  95,  97,  98,
       100, 101, 102, 104, 105, 106, 108, 109, 110, 112, 113, 114, 116,
       117, 118, 119, 120, 121, 123, 124, 125, 126, 127, 128, 128, 129,
       130, 131, 132, 132, 133, 134, 134, 135, 136, 136, 137, 137, 138,
       138, 138, 139, 139, 139, 140, 140, 140, 140, 141, 141, 141, 141,
       141, 141, 141, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142,
       142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142,
       142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142,
       142], dtype=int32)
</pre></div></div>
</div>
<p>Now we assign that <code class="docutils literal notranslate"><span class="pre">tmf</span></code> array to the <code class="docutils literal notranslate"><span class="pre">boxf</span></code> attribute of our group.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">group</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;n_inf&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;box_is_gated&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;boxf&#39;</span><span class="p">:</span> <span class="n">tmf</span><span class="p">}</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;R0&#39;</span><span class="p">:</span> <span class="mf">1.8</span><span class="p">,</span><span class="s1">&#39;imndur&#39;</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="s1">&#39;infdur&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;days&#39;</span><span class="p">:</span> <span class="mi">365</span><span class="p">}</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">Env</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">group</span><span class="p">],</span> <span class="p">[],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;imndur&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;R0&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;infdur&#39;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span>
<span class="n">env</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>

<span class="n">locmat</span><span class="p">,</span> <span class="n">loc_tmf</span> <span class="o">=</span> <span class="n">create_matrix</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;days&#39;</span><span class="p">],</span> <span class="n">env</span><span class="o">.</span><span class="n">boxes</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">gates</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>And in the resulting <code class="docutils literal notranslate"><span class="pre">loc_tmf</span></code> matrix, we can see that each location in the Grid has the same dynamic transmission factor across ticks.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">loc_tmf</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">100</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142,
        142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142,
        142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 141, 141,
        141, 141, 141, 141, 141, 140, 140, 140, 140, 139, 139, 139, 138,
        138, 138, 137, 137, 136, 136, 135, 134, 134, 133, 132, 132, 131,
        130, 129, 128, 128, 127, 126, 125, 124, 123, 121, 120, 119, 118,
        117, 116, 114, 113, 112, 110, 109, 108, 106, 105, 104, 102, 101,
        100,  98,  97,  95,  94,  93,  91,  90,  89],
       [142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142,
        142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142,
        142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 141, 141,
        141, 141, 141, 141, 141, 140, 140, 140, 140, 139, 139, 139, 138,
        138, 138, 137, 137, 136, 136, 135, 134, 134, 133, 132, 132, 131,
        130, 129, 128, 128, 127, 126, 125, 124, 123, 121, 120, 119, 118,
        117, 116, 114, 113, 112, 110, 109, 108, 106, 105, 104, 102, 101,
        100,  98,  97,  95,  94,  93,  91,  90,  89],
       [142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142,
        142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142,
        142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 141, 141,
        141, 141, 141, 141, 141, 140, 140, 140, 140, 139, 139, 139, 138,
        138, 138, 137, 137, 136, 136, 135, 134, 134, 133, 132, 132, 131,
        130, 129, 128, 128, 127, 126, 125, 124, 123, 121, 120, 119, 118,
        117, 116, 114, 113, 112, 110, 109, 108, 106, 105, 104, 102, 101,
        100,  98,  97,  95,  94,  93,  91,  90,  89]], dtype=int32)
</pre></div></div>
</div>
<p>If we invert the cosine waves, we can invert the seasonality curve, thereby mimicking an outbreak beginning in a region’s summer period.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">base</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">s1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">48</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="n">mixed</span> <span class="o">=</span> <span class="n">base</span> <span class="o">+</span> <span class="n">s1</span> <span class="o">+</span> <span class="n">s2</span>
<span class="n">inv_tmf</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">mixed</span> <span class="o">/</span> <span class="n">seasonal_factor</span>
<span class="n">inv_tmf</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">inv_tmf</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This results in the curve below:</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/seasonal_19_0.png" src="_images/seasonal_19_0.png" />
</div>
</div>
<div class="section" id="SIR">
<h2>SIR<a class="headerlink" href="#SIR" title="Permalink to this headline">¶</a></h2>
<p>We’ll now utilize our a pair of seasonality curves in some of the standard simulations demonstrated previously. First, we compare outcomes against the basic <a class="reference external" href="hit.html#1.-Equal">Equal Mover scenario from the SIR section</a>.</p>
<p>The seasonal location factors are applied to every location across all groups. To do so, a box is created covering the entire grid and applied to each group by passing the keywords to each group.</p>
<p>First, we create the <code class="docutils literal notranslate"><span class="pre">params</span></code> for the Winter Start seasonality.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[87]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gkws</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;box&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="s1">&#39;box_is_gated&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;boxf&#39;</span><span class="p">:</span> <span class="n">tmf</span><span class="p">}</span>

<span class="n">group1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;0-19&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2700</span><span class="p">,</span> <span class="n">n_inf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ifr</span><span class="o">=</span><span class="mf">0.00003</span><span class="p">,</span> <span class="o">**</span><span class="n">gkws</span><span class="p">)</span>
<span class="n">group2</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;20-49&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">4100</span><span class="p">,</span> <span class="n">n_inf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ifr</span><span class="o">=</span><span class="mf">0.0002</span><span class="p">,</span> <span class="o">**</span><span class="n">gkws</span><span class="p">)</span>
<span class="n">group3</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;50-69&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2300</span><span class="p">,</span> <span class="n">n_inf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ifr</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="o">**</span><span class="n">gkws</span><span class="p">)</span>
<span class="n">group4</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;70+&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">n_inf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ifr</span><span class="o">=</span><span class="mf">0.054</span><span class="p">,</span> <span class="o">**</span><span class="n">gkws</span><span class="p">)</span>
<span class="n">w_groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span> <span class="n">group3</span><span class="p">,</span> <span class="n">group4</span><span class="p">]</span>

<span class="n">w_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;groups&#39;</span><span class="p">:</span> <span class="n">w_groups</span><span class="p">,</span> <span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="s1">&#39;med&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Ro&#39;</span><span class="p">:</span><span class="mf">2.5</span><span class="p">,</span> <span class="s1">&#39;days&#39;</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="s1">&#39;imndur&#39;</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="s1">&#39;infdur&#39;</span><span class="p">:</span> <span class="mi">14</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>Then, we create the <code class="docutils literal notranslate"><span class="pre">params</span></code> for the Summar Start seasonality.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[88]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>

<span class="n">s_groups</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">w_groups</span><span class="p">)</span>
<span class="n">s_params</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">w_params</span><span class="p">)</span>

<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">s_groups</span><span class="p">:</span>
    <span class="n">group</span><span class="p">[</span><span class="s1">&#39;boxf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inv_tmf</span>

<span class="n">s_params</span><span class="p">[</span><span class="s1">&#39;groups&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">s_groups</span>
</pre></div>
</div>
</div>
<p>We generated 50 simulations encompassing the two seasonal scenarios and the original aseasonal scenario.</p>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-74-a5643e08e420&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> headers <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">r&#39;SIR&lt;br&gt;Winter&lt;br&gt;$R_0$ &gt; 0&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">r&#39;SIR&lt;br&gt;Summer&lt;br&gt;$R_0$ &gt; 0&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">r&#39;SIR&lt;br&gt;Aseasonal&lt;br&gt;$R_0$ &gt; 0&#39;</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>display<span class="ansi-blue-fg">(</span>HTML<span class="ansi-blue-fg">(</span>curve_table<span class="ansi-blue-fg">(</span>headers<span class="ansi-blue-fg">,</span> sir_args<span class="ansi-blue-fg">,</span> sir_sizes<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;sir_args&#39; is not defined
</pre></div></div>
</div>
<p>RESTULS!!!!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="o">**</span><span class="n">w_params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">dotlog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div style="text-align: center">
    <video width='900px' height='376.56903765690373px'
    src="https://storage.googleapis.com/rknotvids/seasonality/base.mp4" controls>Video Failed to Load</video>
</div>
<p></p></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="err">```</span><span class="n">python</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="o">**</span><span class="n">s_params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">dotlog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="err">```</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div style="text-align: center">
    <video width='900px' height='376.56903765690373px'
    src="https://storage.googleapis.com/rknotvids/seasonality/base.mp4" controls>Video Failed to Load</video>
</div>
<p></p></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="o">**</span><span class="n">inv_params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">dotlog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div style="text-align: center">
    <video width='900px' height='376.56903765690373px'
    src="https://storage.googleapis.com/rknotvids/seasonality/winter_sir.mp4" controls>Video Failed to Load</video>
</div>
<p></p></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="Events">
<h2>Events<a class="headerlink" href="#Events" title="Permalink to this headline">¶</a></h2>
<p>We can easily incorporate these location-based, seasonal transmission factors into more complex structures. Below we incorporate the “summer-like” seasonal factors into our <a class="reference internal" href="load.html#Events"><span class="std std-ref">dynamic load, event-based structure</span></a>.</p>
<p><strong>NOTE</strong>: Seasonal factors cannot be created for locations <em>not</em> inside a box. In the event structure, the region where the events occur is inside a VBox, however, the remaining region does <em>not</em> occur in a box and so the no transmission factor is applied. The number of contacts outside of the VBox is a very small portion of the total and so should not impact the result materially.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">rknot</span> <span class="kn">import</span> <span class="n">Sim</span><span class="p">,</span> <span class="n">Chart</span>

<span class="kn">from</span> <span class="nn">rknot.dots.fhutch</span> <span class="kn">import</span> <span class="n">tmr</span>
<span class="kn">from</span> <span class="nn">rknot.sims.us_w_load_18</span> <span class="kn">import</span> <span class="n">events</span>
<span class="kn">from</span> <span class="nn">rknot.events</span> <span class="kn">import</span> <span class="n">Restriction</span><span class="p">,</span> <span class="n">Quarantine</span>
<span class="kn">from</span> <span class="nn">rknot.space</span> <span class="kn">import</span> <span class="n">create_seasonal_factors</span>

<span class="n">rsxns</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">quars</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">events_loc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">Restriction</span><span class="p">):</span>
        <span class="n">rsxns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">Quarantine</span><span class="p">):</span>
        <span class="n">quars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">e</span><span class="o">.</span><span class="n">from_boxes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">e</span><span class="o">.</span><span class="n">no_events</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">events_loc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="n">group1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;0-19&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2700</span><span class="p">,</span> <span class="n">n_inf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ifr</span><span class="o">=</span><span class="mf">0.00003</span><span class="p">,</span> <span class="n">mover</span><span class="o">=.</span><span class="mi">98</span><span class="p">)</span>
<span class="n">group2</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;20-49&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">4100</span><span class="p">,</span> <span class="n">n_inf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ifr</span><span class="o">=</span><span class="mf">0.0002</span><span class="p">,</span> <span class="n">mover</span><span class="o">=.</span><span class="mi">98</span><span class="p">)</span>
<span class="n">group3</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;50-69&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2300</span><span class="p">,</span> <span class="n">n_inf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ifr</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">mover</span><span class="o">=.</span><span class="mi">98</span><span class="p">)</span>
<span class="n">group4</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;70+&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">n_inf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ifr</span><span class="o">=</span><span class="mf">0.054</span><span class="p">,</span> <span class="n">mover</span><span class="o">=.</span><span class="mi">98</span><span class="p">)</span>
<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span> <span class="n">group3</span><span class="p">,</span> <span class="n">group4</span><span class="p">]</span>

<span class="n">tmf</span> <span class="o">=</span> <span class="n">create_seasonal_factors</span><span class="p">()</span>
<span class="n">vbox</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="mi">344</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">:</span> <span class="mi">344</span><span class="p">,</span> <span class="s1">&#39;boxf&#39;</span><span class="p">:</span> <span class="n">tmf</span><span class="p">}</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;groups&#39;</span><span class="p">:</span> <span class="n">groups</span><span class="p">,</span> <span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;days&#39;</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="s1">&#39;tmr_curve&#39;</span><span class="p">:</span> <span class="n">tmr</span><span class="p">,</span>
    <span class="s1">&#39;vboxes&#39;</span><span class="p">:</span> <span class="n">vbox</span><span class="p">,</span> <span class="s1">&#39;events&#39;</span><span class="p">:</span> <span class="n">events_loc</span><span class="p">,</span>
    <span class="s1">&#39;rsxns&#39;</span><span class="p">:</span> <span class="n">rsxns</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">slug</span> <span class="o">=</span> <span class="s1">&#39;events&#39;</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;vids/seasonality&#39;</span>
<span class="k">if</span> <span class="kc">False</span><span class="p">:</span>
    <span class="n">chart_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">reso_format</span><span class="o">=</span><span class="s1">&#39;web&#39;</span><span class="p">,</span> <span class="n">dotsize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

    <span class="n">chart</span> <span class="o">=</span> <span class="n">Chart</span><span class="p">(</span>
        <span class="n">sim</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;tot&#39;</span><span class="p">,</span> <span class="n">show_intro</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_restricted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">chart_params</span>
    <span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;tests&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">slug</span><span class="si">}</span><span class="s1">_peaks.mp4&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
<span class="kn">from</span> <span class="nn">rknot.notebook</span> <span class="kn">import</span> <span class="n">animHTML</span>

<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">animHTML</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;seasonality/</span><span class="si">{</span><span class="n">slug</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div style="text-align: center">
    <video width='900px' height='376.56903765690373px'
    src="https://storage.googleapis.com/rknotvids/seasonality/events.mp4" controls>Video Failed to Load</video>
</div>
<p></p></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">inv_tmf</span> <span class="o">=</span> <span class="n">create_seasonal_factors</span><span class="p">(</span><span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">inv_vbox</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="mi">344</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">:</span> <span class="mi">344</span><span class="p">,</span> <span class="s1">&#39;boxf&#39;</span><span class="p">:</span> <span class="n">inv_tmf</span><span class="p">}</span>
<span class="n">inv_params</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<span class="n">inv_params</span><span class="p">[</span><span class="s1">&#39;vboxes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inv_vbox</span>
</pre></div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="o">**</span><span class="n">inv_params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">slug_inv</span> <span class="o">=</span> <span class="s1">&#39;events_inv&#39;</span>
<span class="k">if</span> <span class="kc">False</span><span class="p">:</span>
    <span class="n">chart_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">reso_format</span><span class="o">=</span><span class="s1">&#39;web&#39;</span><span class="p">,</span> <span class="n">dotsize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

    <span class="n">chart</span> <span class="o">=</span> <span class="n">Chart</span><span class="p">(</span>
        <span class="n">sim</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;tot&#39;</span><span class="p">,</span> <span class="n">show_intro</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_restricted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">chart_params</span>
    <span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;tests&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">slug_inv</span><span class="si">}</span><span class="s1">_peaks.mp4&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
<span class="kn">from</span> <span class="nn">rknot.notebook</span> <span class="kn">import</span> <span class="n">animHTML</span>

<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">animHTML</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;seasonality/</span><span class="si">{</span><span class="n">slug_inv</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div style="text-align: center">
    <video width='900px' height='376.56903765690373px'
    src="https://storage.googleapis.com/rknotvids/seasonality/events_inv.mp4" controls>Video Failed to Load</video>
</div>
<p></p></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">if</span> <span class="kc">False</span><span class="p">:</span>
    <span class="n">sims</span> <span class="o">=</span> <span class="n">pickloop</span><span class="p">(</span>
        <span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">sterile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span> <span class="s1">&#39;slug&#39;</span><span class="p">:</span> <span class="n">slug</span><span class="p">},</span>
        <span class="o">**</span><span class="n">params</span>
    <span class="p">)</span>
    <span class="n">sims</span> <span class="o">=</span> <span class="n">pickloop</span><span class="p">(</span>
        <span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">sterile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span> <span class="s1">&#39;slug&#39;</span><span class="p">:</span> <span class="n">slug_inv</span><span class="p">},</span>
        <span class="o">**</span><span class="n">inv_params</span>
    <span class="p">)</span>
    <span class="n">flat_vbox</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="mi">344</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">:</span> <span class="mi">344</span><span class="p">}</span>
    <span class="n">flat_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;groups&#39;</span><span class="p">:</span> <span class="n">groups</span><span class="p">,</span> <span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;days&#39;</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="s1">&#39;tmr_curve&#39;</span><span class="p">:</span> <span class="n">tmr</span><span class="p">,</span>
        <span class="s1">&#39;vboxes&#39;</span><span class="p">:</span> <span class="n">flat_vbox</span><span class="p">,</span> <span class="s1">&#39;events&#39;</span><span class="p">:</span> <span class="n">events_loc</span><span class="p">,</span>
        <span class="s1">&#39;rsxns&#39;</span><span class="p">:</span> <span class="n">rsxns</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">sims</span> <span class="o">=</span> <span class="n">pickloop</span><span class="p">(</span>
        <span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">sterile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span> <span class="s1">&#39;slug&#39;</span><span class="p">:</span> <span class="s1">&#39;events_flat&#39;</span><span class="p">},</span>
        <span class="o">**</span><span class="n">flat_params</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">slugs</span> <span class="o">=</span> <span class="p">[</span><span class="n">slug</span><span class="p">,</span> <span class="n">slug_inv</span><span class="p">,</span> <span class="s1">&#39;events_flat&#39;</span><span class="p">]</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;sims&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;-pickled&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">slugs</span><span class="p">]</span>
<span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>
    <span class="n">args</span><span class="p">,</span> <span class="n">sizes</span><span class="p">,</span> <span class="n">sims</span> <span class="o">=</span> <span class="n">curve_table_inputs</span><span class="p">(</span><span class="o">*</span><span class="n">files</span><span class="p">,</span> <span class="n">sims_for_each</span><span class="o">=</span><span class="p">[])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 3/3 [00:31&lt;00:00, 10.39s/it]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;Winter&lt;br&gt;$R_0$ &gt; 0&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Summer&lt;br&gt;$R_0$&#39;</span><span class="p">,</span> <span class="s1">&#39;Aseasonal&lt;br&gt;$R_0$&#39;</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">curve_table</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">sizes</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<table class="results-table"><thead><tr><th class="results-table"></th><th class="results-table" style="text-align: center;">Winter<br>$R_0$ > 0</th><th class="results-table" style="text-align: center;">Summer<br>$R_0$</th><th class="results-table" style="text-align: center;">Aseasonal<br>$R_0$</th></tr></thead><tbody><tr><td class="results-table" style="text-align: left;">n, $R_0$ > 0</td><td class="results-table" style="text-align: center;">16</td><td class="results-table" style="text-align: center;">3</td><td class="results-table" style="text-align: center;">16</td></tr><tr><td class="results-table" style="text-align: left;">n</td><td class="results-table" style="text-align: center;">50</td><td class="results-table" style="text-align: center;">50</td><td class="results-table" style="text-align: center;">50</td></tr><tr><td class="results-table" style="text-align: left;">Peak</td><td class="results-table" style="text-align: center;">50.6%</td><td class="results-table" style="text-align: center;">2.3%</td><td class="results-table" style="text-align: center;">33.1%</td></tr><tr><td class="results-table" style="text-align: left;">HIT</td><td class="results-table" style="text-align: center;">56.3%</td><td class="results-table" style="text-align: center;">3.2%</td><td class="results-table" style="text-align: center;">40.8%</td></tr><tr><td class="results-table" style="text-align: left;">Total</td><td class="results-table" style="text-align: center;">64.7%</td><td class="results-table" style="text-align: center;">3.6%</td><td class="results-table" style="text-align: center;">52.8%</td></tr><tr><td class="results-table" style="text-align: left;">Fatalities</td><td class="results-table" style="text-align: center;">0.39%</td><td class="results-table" style="text-align: center;">0.02%</td><td class="results-table" style="text-align: center;">0.35%</td></tr><tr><td class="results-table" style="text-align: left;">%>70</td><td class="results-table" style="text-align: center;">78.8%</td><td class="results-table" style="text-align: center;">53.3%</td><td class="results-table" style="text-align: center;">73.6%</td></tr><tr><td class="results-table" style="text-align: left;">IFR</td><td class="results-table" style="text-align: center;">0.60%</td><td class="results-table" style="text-align: center;">0.45%</td><td class="results-table" style="text-align: center;">0.66%</td></tr><tr><td class="results-table" style="text-align: left;">Days to Peak</td><td class="results-table" style="text-align: center;">62</td><td class="results-table" style="text-align: center;">51</td><td class="results-table" style="text-align: center;">69</td></tr></tbody></table></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="multi.html" class="btn btn-neutral float-left" title="Multiple Jurisdictions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2021 Ryan Skene. All rights reserved.

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>