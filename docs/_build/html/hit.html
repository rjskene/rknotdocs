

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Factors Influencing HIT &mdash; RKnot  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}}, "tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Introduction" href="intro.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> RKnot
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Factors Influencing HIT</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Base-US-Simulation">Base US Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Natural">Natural</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#1.-Equal">1. Equal</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.-Local">2. Local</a></li>
<li class="toctree-l3"><a class="reference internal" href="#3.-Social-Millenials">3. Social Millenials</a></li>
<li class="toctree-l3"><a class="reference internal" href="#4.-Pre-Existing-Immunity">4. Pre-Existing Immunity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#5.-Events">5. Events</a></li>
<li class="toctree-l3"><a class="reference internal" href="#6.-Gates">6. Gates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#7.-Events,-Gates,-and-Pre-Immunity">7. Events, Gates, and Pre-Immunity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#8.-Self-Aware-Social-Distancing">8. Self Aware Social Distancing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#9.-Isolation">9. Isolation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#10.-Infectiousness-Curve">10. Infectiousness Curve</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Policy">Policy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#1.-Restrict-Large-Gatherings">1. Restrict Large Gatherings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.-Restrict-Elderly-Visits">2. Restrict Elderly Visits</a></li>
<li class="toctree-l3"><a class="reference internal" href="#3.-Social-Distancing">3. Social Distancing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#4.-Social-Distancing-and-Restrict-Elderly-Visits-and-Large-Gatherings">4. Social Distancing and Restrict Elderly Visits and Large Gatherings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#5.-Quarantine">5. Quarantine</a></li>
<li class="toctree-l3"><a class="reference internal" href="#6.-Quarantine-Then-Restrictions">6. Quarantine Then Restrictions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#A-Fulsome-Scenario">A Fulsome Scenario</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">RKnot</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Factors Influencing HIT</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/hit.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Factors-Influencing-HIT">
<h1>Factors Influencing HIT<a class="headerlink" href="#Factors-Influencing-HIT" title="Permalink to this headline">¶</a></h1>
<p><em>BETA RELEASE: I should emphasize this project remains in the experimental stage and there are likely many tweaks to come that will improve/change outcomes. I do believe at this stage that the simulation provides good general insights regarding the relationship between various factors and viral spread.</em></p>
<div class="section" id="Base-US-Simulation">
<h2>Base US Simulation<a class="headerlink" href="#Base-US-Simulation" title="Permalink to this headline">¶</a></h2>
<p>To explore the various concepts of RKnot and viral spread, we’ll use a simulation design based on <a class="reference external" href="https://www.cdc.gov/coronavirus/2019-ncov/hcp/planning-scenarios.html">CDC Best Planning Scenario</a> guidelines for COVID-19 characteristics including:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R_0\)</span> 2.5</p></li>
<li><p>IFR for each of 4 age groups</p></li>
</ul>
<p>Other assumptions:</p>
<ul class="simple">
<li><p>Population of <span class="math notranslate nohighlight">\(10,000^1\)</span></p></li>
<li><p>Initial Infected of 2</p></li>
<li><p>Duration of Infectiousness 14 days<span class="math notranslate nohighlight">\(^2\)</span></p></li>
<li><p>Duration of Immunity 365 days</p></li>
<li><p>Density of ~1 subject per location (<code class="docutils literal notranslate"><span class="pre">dlevel='medium'</span></code>)</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(^1\)</span><em>proportionately split among the 4 age groups to match US census data.</em></p>
<p><span class="math notranslate nohighlight">\(^2\)</span><em>equal likelihood of transmission on any day (i.e. no viral load curve)</em></p>
<p><a class="reference external" href="https://www.census.gov/prod/cen2010/briefs/c2010br-03.pdf">US Census Data</a></p>
<p><em>Note while sars-cov-2 is obviously a major focus globally at the moment, the goal of RKnot is to be applicable to any virus (or anything that spreads like a virus)</em></p>
</div>
<div class="section" id="Natural">
<h2>Natural<a class="headerlink" href="#Natural" title="Permalink to this headline">¶</a></h2>
<div class="section" id="1.-Equal">
<h3>1. Equal<a class="headerlink" href="#1.-Equal" title="Permalink to this headline">¶</a></h3>
<p>The first simulation makes the most homogeneous assumptions.</p>
<ul class="simple">
<li><p>No group is restricted in terms of movement.</p></li>
<li><p>All dots are able to interact with one another.</p></li>
<li><p>All dots are susceptible at initiation.</p></li>
<li><p>All dots are equally likely to move to any dot on the grid (<code class="docutils literal notranslate"><span class="pre">mover='equal'</span></code>)</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">group1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;0-19&#39;</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">2700</span><span class="p">,</span>
    <span class="n">n_inf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">ifr</span><span class="o">=</span><span class="mf">0.00003</span><span class="p">,</span>
    <span class="n">mover</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">group2</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;20-49&#39;</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">4100</span><span class="p">,</span>
    <span class="n">n_inf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ifr</span><span class="o">=</span><span class="mf">0.0002</span><span class="p">,</span>
    <span class="n">mover</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">group3</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;50-69&#39;</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">2300</span><span class="p">,</span>
    <span class="n">n_inf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ifr</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
    <span class="n">mover</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">group4</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;70+&#39;</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span>
    <span class="n">n_inf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">ifr</span><span class="o">=</span><span class="mf">0.054</span><span class="p">,</span>
    <span class="n">mover</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span> <span class="n">group3</span><span class="p">,</span> <span class="n">group4</span><span class="p">]</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dlevel&#39;</span><span class="p">:</span> <span class="s1">&#39;med&#39;</span><span class="p">,</span> <span class="s1">&#39;Ro&#39;</span><span class="p">:</span><span class="mf">2.5</span><span class="p">,</span> <span class="s1">&#39;days&#39;</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="s1">&#39;imndur&#39;</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="s1">&#39;infdur&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">rknot.sim</span> <span class="kn">import</span> <span class="n">Sim</span>

<span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2020-10-06 11:14:38,049 INFO resource_spec.py:223 -- Starting Ray with 11.28 GiB memory available for workers and up to 5.66 GiB for objects. You can adjust these settings with ray.init(memory=&lt;bytes&gt;, object_store_memory=&lt;bytes&gt;).
2020-10-06 11:14:38,588 INFO services.py:1191 -- View the Ray dashboard at <span class="ansi-green-intense-fg ansi-bold">localhost:8265</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------------------------------------------------------
|                                  SIM DETAILS                                  |
|-------------------------------------------------------------------------------|
|           boundary|  [  1 100   1 100]|             n_locs|              10000|
|-------------------|-------------------|-------------------|-------------------|
|                  n|              10000|            density|                1.0|
|-------------------|-------------------|-------------------|-------------------|
|                ktr|                1.0|                tmr|               0.18|
|-------------------|-------------------|-------------------|-------------------|
</pre></div></div>
</div>
<p>Running the animation will result in a video as per below:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">rknot.animate</span> <span class="kn">import</span> <span class="n">SimChart</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">SimChart</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">chart</span><span class="o">.</span><span class="n">animate</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">()</span>
</pre></div>
</div>
</div>
<video width="705" height="340" src="https://storage.googleapis.com/rknotvids/baseus/1.mp4" controls><p>alternative text</p>
</video><p><em>Note embedded videos are used for convenience purposes. Given the random processes involved, running the same code will produce slightly different results each time.</em></p>
<p>The sim results in a relatively standard spread curve with</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Peak</p></td>
<td><p>47%</p></td>
</tr>
<tr class="row-even"><td><p>HIT</p></td>
<td><p>71%</p></td>
</tr>
<tr class="row-odd"><td><p>Fatalities</p></td>
<td><p>0.5%</p></td>
</tr>
</tbody>
</table>
<p>You’ll note this is higher than the expected HIT of 60% for <span class="math notranslate nohighlight">\(R_0\)</span> 2.5. The differences result given:</p>
<ol class="arabic simple">
<li><p>The simulation is a stochastic process and random variation will result in variation from the mathematical model in smaller populations.</p></li>
<li><p>This is not an entirely homogeneous population, with different IFRs and different numbers of contacts between subjects. In particular, because dots can occupy the same location at the same time, and <a class="reference internal" href="intro.html#Likelihood-of-Transmission"><span class="std std-ref">multiple infected dots at the same location increase the transmission rate for any susceptible</span></a>, this tends to lead to faster spread than <span class="math notranslate nohighlight">\(R_0\)</span> would suggest.</p></li>
</ol>
</div>
<div class="section" id="2.-Local">
<h3>2. Local<a class="headerlink" href="#2.-Local" title="Permalink to this headline">¶</a></h3>
<p>In remaining simulations, we begin to introduce ever increasing homogeneity.</p>
<p>Our first change is change all of the subjects mover functions to <code class="docutils literal notranslate"><span class="pre">local</span></code>. The <code class="docutils literal notranslate"><span class="pre">local</span></code> mover has a strong bias towards locations only in its immediate vicinity, which is a better approximation of real world processes (though certainly not a perfect one).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">group1</span><span class="p">[</span><span class="s1">&#39;mover&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;local&#39;</span>
<span class="n">group2</span><span class="p">[</span><span class="s1">&#39;mover&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;local&#39;</span>
<span class="n">group3</span><span class="p">[</span><span class="s1">&#39;mover&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;local&#39;</span>
<span class="n">group4</span><span class="p">[</span><span class="s1">&#39;mover&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;local&#39;</span>
<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span> <span class="n">group3</span><span class="p">,</span> <span class="n">group4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">SimChart</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">chart</span><span class="o">.</span><span class="n">animate</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2020-10-06 11:14:42,601 INFO resource_spec.py:223 -- Starting Ray with 11.47 GiB memory available for workers and up to 5.76 GiB for objects. You can adjust these settings with ray.init(memory=&lt;bytes&gt;, object_store_memory=&lt;bytes&gt;).
2020-10-06 11:14:43,110 INFO services.py:1191 -- View the Ray dashboard at <span class="ansi-green-intense-fg ansi-bold">localhost:8265</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------------------------------------------------------
|                                  SIM DETAILS                                  |
|-------------------------------------------------------------------------------|
|           boundary|  [  1 100   1 100]|             n_locs|              10000|
|-------------------|-------------------|-------------------|-------------------|
|                  n|              10000|            density|                1.0|
|-------------------|-------------------|-------------------|-------------------|
|                ktr|                1.0|                tmr|               0.18|
|-------------------|-------------------|-------------------|-------------------|
</pre></div></div>
</div>
<video width="705" height="340" src="https://storage.googleapis.com/rknotvids/baseus/2.mp4" controls><p>Video Failed To Load</p>
</video><p>We can see from the animation above that by restricting movement, viral spread occurs in a much slower fashion with peak infection rate of just 6% and a HIT of 39%.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Peak</p></td>
<td><p>6%</p></td>
</tr>
<tr class="row-even"><td><p>HIT</p></td>
<td><p>39%</p></td>
</tr>
<tr class="row-odd"><td><p>Fatalities</p></td>
<td><p>0.3%</p></td>
</tr>
</tbody>
</table>
<p><em>CAUTION: RKnot estimates transmission rate assuming all subjects are ``equal`` movers. Thus, where ``local`` movers are used, the transmission rate may be underestimated and result in the much lower transmission witnessed.</em></p>
</div>
<div class="section" id="3.-Social-Millenials">
<h3>3. Social Millenials<a class="headerlink" href="#3.-Social-Millenials" title="Permalink to this headline">¶</a></h3>
<p>In this simulation, we set <code class="docutils literal notranslate"><span class="pre">mover=social</span></code> for just the 20-49 age group. This is a rough approximation of that group’s real-world propensity to travel more frequently (or go to more events).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">group1</span><span class="p">[</span><span class="s1">&#39;mover&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;local&#39;</span>
<span class="n">group2</span><span class="p">[</span><span class="s1">&#39;mover&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;social&#39;</span>
<span class="n">group3</span><span class="p">[</span><span class="s1">&#39;mover&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;local&#39;</span>
<span class="n">group4</span><span class="p">[</span><span class="s1">&#39;mover&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;local&#39;</span>
<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span> <span class="n">group3</span><span class="p">,</span> <span class="n">group4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">SimChart</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">chart</span><span class="o">.</span><span class="n">animate</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2020-10-06 11:14:46,833 INFO resource_spec.py:223 -- Starting Ray with 11.33 GiB memory available for workers and up to 5.68 GiB for objects. You can adjust these settings with ray.init(memory=&lt;bytes&gt;, object_store_memory=&lt;bytes&gt;).
2020-10-06 11:14:47,362 INFO services.py:1191 -- View the Ray dashboard at <span class="ansi-green-intense-fg ansi-bold">localhost:8265</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------------------------------------------------------
|                                  SIM DETAILS                                  |
|-------------------------------------------------------------------------------|
|           boundary|  [  1 100   1 100]|             n_locs|              10000|
|-------------------|-------------------|-------------------|-------------------|
|                  n|              10000|            density|                1.0|
|-------------------|-------------------|-------------------|-------------------|
|                ktr|                1.0|                tmr|               0.18|
|-------------------|-------------------|-------------------|-------------------|
</pre></div></div>
</div>
<video width="705" height="340" src="https://storage.googleapis.com/rknotvids/baseus/3.mp4" controls><p>Video Failed To Load</p>
</video><p>This results in:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Peak</p></td>
<td><p>38%</p></td>
</tr>
<tr class="row-even"><td><p>HIT</p></td>
<td><p>67%</p></td>
</tr>
<tr class="row-odd"><td><p>Fatalities</p></td>
<td><p>0.4%</p></td>
</tr>
</tbody>
</table>
<p>We can see how powerful mixing is within a population. Even with the majority of subjects moving only locally, if a large enough population is moving broadly across the space, it will significantly increase the rate of spread.</p>
</div>
<div class="section" id="4.-Pre-Existing-Immunity">
<h3>4. Pre-Existing Immunity<a class="headerlink" href="#4.-Pre-Existing-Immunity" title="Permalink to this headline">¶</a></h3>
<p>In this scenario, we adjust the susceptibility factor for just two groups by relatively small amounts as follows:</p>
<ul class="simple">
<li><p>20-49: 80%</p></li>
<li><p>50-69: 65%</p></li>
</ul>
<p>This means, in the inverse, that 10% and 25% of the subjects in the respective groups are already immune to the virus (whether through pre-existing T-cell immunity, anti-bodies, or otherwise).</p>
<p>The older group is assumed to have a lower susceptibility factor as it is more likely that older people will have had more exposure to similar viruses over their lifetime.</p>
<p>T-cell immunity to sars-cov-2 remains a controversial subject, but <a class="reference external" href="https://www.bmj.com/content/370/bmj.m3563">many studies</a> have found T-cell prevalance in between 20% - 50% of in <em>people unexposed to sars-cov-2</em>. It is suggested that exposure to “common cold” coronaviruses (or more dangerous ones) may convey this immunity.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">group2</span><span class="p">[</span><span class="s1">&#39;susf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="n">group3</span><span class="p">[</span><span class="s1">&#39;susf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">65</span>
<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span> <span class="n">group3</span><span class="p">,</span> <span class="n">group4</span><span class="p">]</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">SimChart</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">chart</span><span class="o">.</span><span class="n">animate</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">()</span>
</pre></div>
</div>
</div>
<video width="705" height="340" src="https://storage.googleapis.com/rknotvids/baseus/4.mp4" controls><p>Video Failed to Load</p>
</video><p>This results in:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Peak</p></td>
<td><p>23%</p></td>
</tr>
<tr class="row-even"><td><p>HIT</p></td>
<td><p>45%</p></td>
</tr>
<tr class="row-odd"><td><p>Fatalities</p></td>
<td><p>0.4%</p></td>
</tr>
</tbody>
</table>
<p>We can see that pre-existing immunity would significantly reduce HIT, but perhaps not impact the fatality rate. This is likely because, in this Sim, the elderly are assumed to <em>not</em> have pre-existing immunity.</p>
</div>
<div class="section" id="5.-Events">
<h3>5. Events<a class="headerlink" href="#5.-Events" title="Permalink to this headline">¶</a></h3>
<p>Certainly, the vast majority of people in the US do not move in such pre-defined ways as set out by the <code class="docutils literal notranslate"><span class="pre">mover</span></code> function. In reality, people tend to move with a local bias with a small number of interactions, supplemented by larger movements to locations with a large number of interactions in a small amount of time.</p>
<p>In RKnot, we can simulate this with Event objects. And we will incorporate a number of them in this simulation.</p>
<p>First, we will reset the susceptibility factors of all the groups to 1 and reset all <code class="docutils literal notranslate"><span class="pre">mover</span></code> functions to <code class="docutils literal notranslate"><span class="pre">local</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">group2</span><span class="p">[</span><span class="s1">&#39;mover&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;local&#39;</span>
<span class="n">group2</span><span class="p">[</span><span class="s1">&#39;susf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">group3</span><span class="p">[</span><span class="s1">&#39;susf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span> <span class="n">group3</span><span class="p">,</span> <span class="n">group4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Then we will instantiate a handful of events recurring periodically over the duration of the sim.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">rknot.events</span> <span class="kn">import</span> <span class="n">Event</span>

<span class="n">school1</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;school1&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">25</span><span class="p">,</span><span class="mi">42</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">school2</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;school2&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">78</span><span class="p">,</span><span class="mi">82</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">game</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;game&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">84</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">concert1</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;concert1&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">concert2</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;concert2&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">91</span><span class="p">,</span><span class="mi">92</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">bar</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">bar2</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;bar2&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">87</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">bar3</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;bar3&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">52</span><span class="p">,</span><span class="mi">89</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">church</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;church&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">91</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">events</span> <span class="o">=</span> <span class="p">[</span><span class="n">school1</span><span class="p">,</span> <span class="n">school2</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">concert1</span><span class="p">,</span> <span class="n">concert2</span><span class="p">,</span> <span class="n">bar</span><span class="p">,</span> <span class="n">bar2</span><span class="p">,</span> <span class="n">bar3</span><span class="p">,</span> <span class="n">church</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">SimChart</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">chart</span><span class="o">.</span><span class="n">animate</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2020-10-06 11:14:51,065 INFO resource_spec.py:223 -- Starting Ray with 11.23 GiB memory available for workers and up to 5.64 GiB for objects. You can adjust these settings with ray.init(memory=&lt;bytes&gt;, object_store_memory=&lt;bytes&gt;).
2020-10-06 11:14:51,559 INFO services.py:1191 -- View the Ray dashboard at <span class="ansi-green-intense-fg ansi-bold">localhost:8265</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------------------------------------------------------
|                                  SIM DETAILS                                  |
|-------------------------------------------------------------------------------|
|           boundary|  [  1 100   1 100]|             n_locs|              10000|
|-------------------|-------------------|-------------------|-------------------|
|                  n|              10000|            density|                1.0|
|-------------------|-------------------|-------------------|-------------------|
|                ktr|                1.0|                tmr|               0.18|
|-------------------|-------------------|-------------------|-------------------|
</pre></div></div>
</div>
<video width="705" height="340" src="https://storage.googleapis.com/rknotvids/baseus/5.mp4" controls><p>Video Failed to Load</p>
</video><p>This results in:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Peak</p></td>
<td><p>18%</p></td>
</tr>
<tr class="row-even"><td><p>HIT</p></td>
<td><p>49%</p></td>
</tr>
<tr class="row-odd"><td><p>Fatalities</p></td>
<td><p>0.5%</p></td>
</tr>
</tbody>
</table>
<p>We can see that this sort of event-based structure resulted in lower peak infections and HIT relative to Example 3. The curve is flatter and longer.</p>
<p>The selection of events here is relatively arbitrary and perhaps not perfectly illustrative of the nature of movement but it does highlight how more heterogeneous movement might lead to lower HIT.</p>
</div>
<div class="section" id="6.-Gates">
<h3>6. Gates<a class="headerlink" href="#6.-Gates" title="Permalink to this headline">¶</a></h3>
<p>We can further improve the real world interactions by introducing gates. Subjects are not always freely able to interact with all other people in a population. Often their movement is restricted to within certain areas. Furthermore, other people’s access into those areas is restricted.</p>
<p>Elderly people living in retirement homes or assisted living centers is an example. To simulate this, we will split <code class="docutils literal notranslate"><span class="pre">group4</span></code> into two separate groups.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">group4a</span></code></p>
<ul>
<li><p>population of 600 (2/3s of <code class="docutils literal notranslate"><span class="pre">group4</span></code>)</p></li>
<li><p>IFR of 4.2%</p></li>
<li><p>move freely throughout the entire grid as previously</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">group4b</span></code></p>
<ul>
<li><p>population of 300 (1/3rd of <code class="docutils literal notranslate"><span class="pre">group4</span></code>)</p></li>
<li><p>IFR of 7.8%</p></li>
<li><p>movement restricted to 6x6 box</p></li>
</ul>
</li>
</ul>
<p>We have also adjusted the IFR on the basis that <code class="docutils literal notranslate"><span class="pre">group4b</span></code> is likely older and also probably more frail than <code class="docutils literal notranslate"><span class="pre">group4a</span></code>. IFRs approximate those found <a class="reference external" href="https://www.publichealthontario.ca/-/media/documents/ncov/epi/2020/06/covid19-epi-case-identification-age-only-template.pdf?la=en">here</a>.</p>
<p>In addition, we will update certain events to account for the additional group including adding an event specifically for the new group.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">group4a</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;70+&#39;</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
    <span class="n">n_inf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">ifr</span><span class="o">=</span><span class="mf">0.042</span><span class="p">,</span>
    <span class="n">mover</span><span class="o">=</span><span class="s1">&#39;local&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">group4b</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;70+G&#39;</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">n_inf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">ifr</span><span class="o">=</span><span class="mf">0.0683</span><span class="p">,</span>
    <span class="n">mover</span><span class="o">=</span><span class="s1">&#39;local&#39;</span><span class="p">,</span>
    <span class="n">box</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
    <span class="n">box_is_gated</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span> <span class="n">group3</span><span class="p">,</span> <span class="n">group4a</span><span class="p">,</span> <span class="n">group4b</span><span class="p">]</span>
<span class="n">game</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;game&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">84</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">church</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;church&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">91</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">church2</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;church&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">events</span> <span class="o">=</span> <span class="p">[</span><span class="n">game</span><span class="p">,</span> <span class="n">concert1</span><span class="p">,</span> <span class="n">concert2</span><span class="p">,</span> <span class="n">bar</span><span class="p">,</span> <span class="n">bar2</span><span class="p">,</span> <span class="n">bar3</span><span class="p">,</span> <span class="n">church</span><span class="p">,</span> <span class="n">church2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Now, such elderly populations are not totally sealed of from the rest of the world. In fact, they are often visited by family members or friends. We can mimick this with the use of a Travel object.</p>
<p>In this sim, at least one person will enter into the <code class="docutils literal notranslate"><span class="pre">group4b</span></code> gate for a day only. And this will repeat every day of the sim.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">rknot.events</span> <span class="kn">import</span> <span class="n">Travel</span>
<span class="n">visit</span> <span class="o">=</span> <span class="n">Travel</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;visit&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">visit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">SimChart</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">chart</span><span class="o">.</span><span class="n">animate</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2020-10-06 11:14:55,389 INFO resource_spec.py:223 -- Starting Ray with 11.23 GiB memory available for workers and up to 5.62 GiB for objects. You can adjust these settings with ray.init(memory=&lt;bytes&gt;, object_store_memory=&lt;bytes&gt;).
2020-10-06 11:14:55,911 INFO services.py:1191 -- View the Ray dashboard at <span class="ansi-green-intense-fg ansi-bold">localhost:8265</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------------------------------------------------------
|                                  SIM DETAILS                                  |
|-------------------------------------------------------------------------------|
|           boundary|  [  1 100   1 100]|             n_locs|              10000|
|-------------------|-------------------|-------------------|-------------------|
|                  n|              10000|            density|                1.0|
|-------------------|-------------------|-------------------|-------------------|
|                ktr|                1.0|                tmr|               0.18|
|-------------------|-------------------|-------------------|-------------------|
</pre></div></div>
</div>
<video width="705" height="340" src="https://storage.googleapis.com/rknotvids/baseus/6.mp4" controls><p>Video Failed to Load</p>
</video><p>This results in:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Peak</p></td>
<td><p>26%</p></td>
</tr>
<tr class="row-even"><td><p>HIT</p></td>
<td><p>60%</p></td>
</tr>
<tr class="row-odd"><td><p>Fatalities</p></td>
<td><p>0.5%</p></td>
</tr>
</tbody>
</table>
<p>This gated structure results in essentially no impact. The use for this structure will become more evident in the disucssion on <a class="reference external" href="#Policy">Policy Decisions.</a></p>
</div>
<div class="section" id="7.-Events,-Gates,-and-Pre-Immunity">
<h3>7. Events, Gates, and Pre-Immunity<a class="headerlink" href="#7.-Events,-Gates,-and-Pre-Immunity" title="Permalink to this headline">¶</a></h3>
<p>Now we can see how pre-immunity might impact viral spread in a population with more homogeneous interactions.</p>
<p>We will also split <code class="docutils literal notranslate"><span class="pre">group2</span></code> into two separate groups with different movers (<code class="docutils literal notranslate"><span class="pre">group2a</span></code> and <code class="docutils literal notranslate"><span class="pre">group2b</span></code>. The 20-49 age group is a large cohort and not all members will move in the same way. Some will move socially, other more locally.</p>
<p>Then, we update the group list and update our events for the new group structure.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">group2</span><span class="p">[</span><span class="s1">&#39;susf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>
<span class="n">group3</span><span class="p">[</span><span class="s1">&#39;susf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">65</span>
<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span> <span class="n">group3</span><span class="p">,</span> <span class="n">group4a</span><span class="p">,</span> <span class="n">group4b</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">game</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;game&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">84</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">concert1</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;concert1&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">concert2</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;concert2&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">91</span><span class="p">,</span><span class="mi">92</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">bar</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">bar2</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;bar2&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">87</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">bar3</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;bar3&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">52</span><span class="p">,</span><span class="mi">89</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">church</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;church&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">91</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">church2</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;church&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">visit</span> <span class="o">=</span> <span class="n">Travel</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;visit&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">events</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">school1</span><span class="p">,</span> <span class="n">school2</span><span class="p">,</span>
    <span class="n">game</span><span class="p">,</span> <span class="n">concert1</span><span class="p">,</span> <span class="n">concert2</span><span class="p">,</span> <span class="n">bar</span><span class="p">,</span> <span class="n">bar2</span><span class="p">,</span> <span class="n">bar3</span><span class="p">,</span>
    <span class="n">church</span><span class="p">,</span> <span class="n">church2</span><span class="p">,</span> <span class="n">visit</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">SimChart</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">chart</span><span class="o">.</span><span class="n">animate</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2020-10-06 11:14:59,751 INFO resource_spec.py:223 -- Starting Ray with 11.18 GiB memory available for workers and up to 5.59 GiB for objects. You can adjust these settings with ray.init(memory=&lt;bytes&gt;, object_store_memory=&lt;bytes&gt;).
2020-10-06 11:15:00,249 INFO services.py:1191 -- View the Ray dashboard at <span class="ansi-green-intense-fg ansi-bold">localhost:8265</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------------------------------------------------------
|                                  SIM DETAILS                                  |
|-------------------------------------------------------------------------------|
|           boundary|  [  1 100   1 100]|             n_locs|              10000|
|-------------------|-------------------|-------------------|-------------------|
|                  n|              10000|            density|                1.0|
|-------------------|-------------------|-------------------|-------------------|
|                ktr|                1.0|                tmr|               0.18|
|-------------------|-------------------|-------------------|-------------------|
</pre></div></div>
</div>
<video width="705" height="340" src="https://storage.googleapis.com/rknotvids/baseus/7.mp4" controls><p>Video Failed to Load</p>
</video><p>This results in:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Peak</p></td>
<td><p>16%</p></td>
</tr>
<tr class="row-even"><td><p>HIT</p></td>
<td><p>33%</p></td>
</tr>
<tr class="row-odd"><td><p>Fatalities</p></td>
<td><p>0.4%</p></td>
</tr>
</tbody>
</table>
<p>So once again we see that pre-existing immunity would have the effect of significanlty reducing peak infections, HIT, and fatalities. Also note the longer tail that results compared to Example 4 (the flatter the curve, the longer the tail).</p>
</div>
<div class="section" id="8.-Self-Aware-Social-Distancing">
<h3>8. Self Aware Social Distancing<a class="headerlink" href="#8.-Self-Aware-Social-Distancing" title="Permalink to this headline">¶</a></h3>
<p>In a self-aware population, we can also incorporate an assumption that certain members of the population will implement social distancing practices (even in the absence of prescribed government policy). For example, individuals might wear masks or face shields while in public.</p>
<p>This is implemented via a SocialDistancing object, which reduces the transmission factor of the subjects in the applicable group.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">rknot.events</span> <span class="kn">import</span> <span class="n">SocialDistancing</span> <span class="k">as</span> <span class="n">SD</span>

<span class="n">sd</span> <span class="o">=</span> <span class="n">SD</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;6-feet&#39;</span><span class="p">,</span> <span class="n">tmfs</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">975</span><span class="p">,</span><span class="o">.</span><span class="mi">95</span><span class="p">,</span><span class="o">.</span><span class="mi">75</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

<span class="n">events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">SimChart</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">chart</span><span class="o">.</span><span class="n">animate</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2020-10-06 11:15:03,827 INFO resource_spec.py:223 -- Starting Ray with 11.13 GiB memory available for workers and up to 5.58 GiB for objects. You can adjust these settings with ray.init(memory=&lt;bytes&gt;, object_store_memory=&lt;bytes&gt;).
2020-10-06 11:15:04,318 INFO services.py:1191 -- View the Ray dashboard at <span class="ansi-green-intense-fg ansi-bold">localhost:8265</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------------------------------------------------------
|                                  SIM DETAILS                                  |
|-------------------------------------------------------------------------------|
|           boundary|  [  1 100   1 100]|             n_locs|              10000|
|-------------------|-------------------|-------------------|-------------------|
|                  n|              10000|            density|                1.0|
|-------------------|-------------------|-------------------|-------------------|
|                ktr|                1.0|                tmr|               0.18|
|-------------------|-------------------|-------------------|-------------------|
</pre></div></div>
</div>
<video width="705" height="340" src="https://storage.googleapis.com/rknotvids/baseus/8.mp4" controls><p>Video Failed to Load</p>
</video><p>This results in:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Peak</p></td>
<td><p>12%</p></td>
</tr>
<tr class="row-even"><td><p>HIT</p></td>
<td><p>34%</p></td>
</tr>
<tr class="row-odd"><td><p>Fatalities</p></td>
<td><p>0.2%</p></td>
</tr>
</tbody>
</table>
<p>Here we can that social distancing in a population does have a modest impact on peak infections. We also can see that social distancing among the most susceptible (i.e. <code class="docutils literal notranslate"><span class="pre">group4b</span></code>) was a key factor in a dramatically reduced fatality rate (50-75% reduction in fatalities).</p>
<p>Essentially, in this simulation, social distancing prevented an outbreak in the <code class="docutils literal notranslate"><span class="pre">group4b</span></code> community (whereas outbreaks had previously occured there in prior sims).</p>
<p>*Note that randomness in an important factor in viral transmission, so the results of the sim above will not be repeatable every time, though on balance we would expect this outcome to occur more often than in say, Example 7.</p>
</div>
<div class="section" id="9.-Isolation">
<h3>9. Isolation<a class="headerlink" href="#9.-Isolation" title="Permalink to this headline">¶</a></h3>
<p>TBD</p>
</div>
<div class="section" id="10.-Infectiousness-Curve">
<h3>10. Infectiousness Curve<a class="headerlink" href="#10.-Infectiousness-Curve" title="Permalink to this headline">¶</a></h3>
<p>TBD</p>
</div>
</div>
<div class="section" id="Policy">
<h2>Policy<a class="headerlink" href="#Policy" title="Permalink to this headline">¶</a></h2>
<p>With a more realistic model of subject interaction, we can begin to experiment with the impact of different policy measures.</p>
<p>RKnot can simulate policy measures via <code class="docutils literal notranslate"><span class="pre">Restriction</span></code>, <code class="docutils literal notranslate"><span class="pre">SocialDistancing</span></code>, and <code class="docutils literal notranslate"><span class="pre">Quarantine</span></code> objects.</p>
<p>First we will reset our groups. We will maintain the 5 group structure with 2/3rds of the 70+ population gated. No groups will have pre-existing immunity. Remaining characteristics are as <a class="reference external" href="#">per here</a>.</p>
<p>Events are as <a class="reference external" href="#">per here</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">group1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;0-19&#39;</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">2700</span><span class="p">,</span>
    <span class="n">n_inf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">ifr</span><span class="o">=</span><span class="mf">0.00003</span><span class="p">,</span>
    <span class="n">mover</span><span class="o">=</span><span class="s1">&#39;local&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">group2</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;20-49&#39;</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">4100</span><span class="p">,</span>
    <span class="n">n_inf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ifr</span><span class="o">=</span><span class="mf">0.0002</span><span class="p">,</span>
    <span class="n">mover</span><span class="o">=</span><span class="s1">&#39;local&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">group3</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;50-69&#39;</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">2300</span><span class="p">,</span>
    <span class="n">n_inf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ifr</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
    <span class="n">mover</span><span class="o">=</span><span class="s1">&#39;local&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">group4a</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;70+&#39;</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
    <span class="n">n_inf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">ifr</span><span class="o">=</span><span class="mf">0.042</span><span class="p">,</span>
    <span class="n">mover</span><span class="o">=</span><span class="s1">&#39;local&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">group4b</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;70+G&#39;</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">n_inf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">ifr</span><span class="o">=</span><span class="mf">0.0683</span><span class="p">,</span>
    <span class="n">mover</span><span class="o">=</span><span class="s1">&#39;local&#39;</span><span class="p">,</span>
    <span class="n">box</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
    <span class="n">box_is_gated</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span> <span class="n">group3</span><span class="p">,</span> <span class="n">group4a</span><span class="p">,</span> <span class="n">group4b</span><span class="p">]</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dlevel&#39;</span><span class="p">:</span> <span class="s1">&#39;med&#39;</span><span class="p">,</span> <span class="s1">&#39;Ro&#39;</span><span class="p">:</span><span class="mf">2.5</span><span class="p">,</span> <span class="s1">&#39;days&#39;</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="s1">&#39;imndur&#39;</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="s1">&#39;infdur&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">rknot.events</span> <span class="kn">import</span> <span class="n">Event</span><span class="p">,</span> <span class="n">Travel</span>

<span class="n">school1</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;school1&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">25</span><span class="p">,</span><span class="mi">42</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">school2</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;school2&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">78</span><span class="p">,</span><span class="mi">82</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">game</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;game&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">84</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">concert1</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;concert1&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">concert2</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;concert2&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">91</span><span class="p">,</span><span class="mi">92</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">bar</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">bar2</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;bar2&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">87</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">bar3</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;bar3&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">52</span><span class="p">,</span><span class="mi">89</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">church</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;church&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">91</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">church2</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;church&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">visit</span> <span class="o">=</span> <span class="n">Travel</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;visit&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">events</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">school1</span><span class="p">,</span> <span class="n">school2</span><span class="p">,</span>
    <span class="n">game</span><span class="p">,</span> <span class="n">concert1</span><span class="p">,</span> <span class="n">concert2</span><span class="p">,</span> <span class="n">bar</span><span class="p">,</span> <span class="n">bar2</span><span class="p">,</span> <span class="n">bar3</span><span class="p">,</span>
    <span class="n">church</span><span class="p">,</span> <span class="n">church2</span><span class="p">,</span> <span class="n">visit</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="1.-Restrict-Large-Gatherings">
<h3>1. Restrict Large Gatherings<a class="headerlink" href="#1.-Restrict-Large-Gatherings" title="Permalink to this headline">¶</a></h3>
<p>We’ll start by simply restricting large gathers, which for this sim is any event with 10+ capacity (0.1% of the entire population). The restrictions will last for 60 days.</p>
<p>When considering capacity, remember that a 100,000-seat stadium in a 10 million person catchment represents 1% of the population.</p>
<p>We assume this policy are implemented on day 30, when the population finally realizes there is a pandemic and government has had time to implement prevention measures.</p>
<p>The restriction will last for 60 days.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">rknot.events</span> <span class="kn">import</span> <span class="n">Restriction</span>

<span class="n">large_gatherings</span> <span class="o">=</span> <span class="n">Restriction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;capacity&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">events_w_res</span> <span class="o">=</span> <span class="n">events</span> <span class="o">+</span> <span class="p">[</span><span class="n">large_gatherings</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events_w_res</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">SimChart</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">chart</span><span class="o">.</span><span class="n">animate</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2020-10-06 11:15:07,855 INFO resource_spec.py:223 -- Starting Ray with 11.13 GiB memory available for workers and up to 5.59 GiB for objects. You can adjust these settings with ray.init(memory=&lt;bytes&gt;, object_store_memory=&lt;bytes&gt;).
2020-10-06 11:15:08,351 INFO services.py:1191 -- View the Ray dashboard at <span class="ansi-green-intense-fg ansi-bold">localhost:8265</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------------------------------------------------------
|                                  SIM DETAILS                                  |
|-------------------------------------------------------------------------------|
|           boundary|  [  1 100   1 100]|             n_locs|              10000|
|-------------------|-------------------|-------------------|-------------------|
|                  n|              10000|            density|                1.0|
|-------------------|-------------------|-------------------|-------------------|
|                ktr|                1.0|                tmr|               0.18|
|-------------------|-------------------|-------------------|-------------------|
</pre></div></div>
</div>
<video width="705" height="340" src="https://storage.googleapis.com/rknotvids/baseus/large.mp4" controls><p>Video Failed to Load</p>
</video><p>This results in:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Peak</p></td>
<td><p>25%</p></td>
</tr>
<tr class="row-even"><td><p>HIT</p></td>
<td><p>56%</p></td>
</tr>
<tr class="row-odd"><td><p>Fatalities</p></td>
<td><p>0.6%</p></td>
</tr>
</tbody>
</table>
<p>We see that the curve is flattened significanlty during the restriction period and the peak of infections has been pushed way out to ~125+ days, but as restrictions are lifted the outbreak ensues and fatalities are actually higher than in many other sims.</p>
</div>
<div class="section" id="2.-Restrict-Elderly-Visits">
<h3>2. Restrict Elderly Visits<a class="headerlink" href="#2.-Restrict-Elderly-Visits" title="Permalink to this headline">¶</a></h3>
<p>We can restrict events by name by passing <code class="docutils literal notranslate"><span class="pre">name</span></code> key to <code class="docutils literal notranslate"><span class="pre">criteria</span></code>.</p>
<p>We can do this to restrict the travel event to the 70+ gated area. This restriction will last for a very long period of time.</p>
<p>There will be no other restrictions.</p>
<p>Policy measure is implemented on day 30 and maintained for another 120 days.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">no_visits</span> <span class="o">=</span> <span class="n">Restriction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;no_visits&#39;</span><span class="p">,</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;visit&#39;</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">events_w_res</span> <span class="o">=</span> <span class="n">events</span> <span class="o">+</span> <span class="p">[</span><span class="n">no_visits</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events_w_res</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">SimChart</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">chart</span><span class="o">.</span><span class="n">animate</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2020-10-06 11:15:12,250 INFO resource_spec.py:223 -- Starting Ray with 11.08 GiB memory available for workers and up to 5.56 GiB for objects. You can adjust these settings with ray.init(memory=&lt;bytes&gt;, object_store_memory=&lt;bytes&gt;).
2020-10-06 11:15:12,741 INFO services.py:1191 -- View the Ray dashboard at <span class="ansi-green-intense-fg ansi-bold">localhost:8265</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------------------------------------------------------
|                                  SIM DETAILS                                  |
|-------------------------------------------------------------------------------|
|           boundary|  [  1 100   1 100]|             n_locs|              10000|
|-------------------|-------------------|-------------------|-------------------|
|                  n|              10000|            density|                1.0|
|-------------------|-------------------|-------------------|-------------------|
|                ktr|                1.0|                tmr|               0.18|
|-------------------|-------------------|-------------------|-------------------|
</pre></div></div>
</div>
<video width="705" height="340" src="https://storage.googleapis.com/rknotvids/baseus/no_visits.mp4" controls><p>Video Failed to Load</p>
</video><p>This results in:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Peak</p></td>
<td><p>25%</p></td>
</tr>
<tr class="row-even"><td><p>HIT</p></td>
<td><p>54%</p></td>
</tr>
<tr class="row-odd"><td><p>Fatalities</p></td>
<td><p>0.3%</p></td>
</tr>
</tbody>
</table>
<p>While this approach does not have big impact on viral spread, it is the <em>only policy measure that reduces fatalities in the long run</em>. The most susceptible are protected during the peak and the virus has “burned out” fast enough that the elderly are not infected when visits resume.</p>
</div>
<div class="section" id="3.-Social-Distancing">
<h3>3. Social Distancing<a class="headerlink" href="#3.-Social-Distancing" title="Permalink to this headline">¶</a></h3>
<p>We can mimick the implementation of Social Distancing policies in certain settings via the SocialDistancing object. Mask wearing, hand sanitizing, and 6-foot perimeters all provided varying levels of protection.</p>
<p>It is hard to estimate the degree of protection by each, and even harder in combination. For instance, <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/23498357/">this study</a> found anywhere between a 1.1- and 55-fold reduction in exposure to influenze with varying mask designs.</p>
<p>So we provide tmfs here for illustration purposes only, attempting to catch all social distancing practices. We also provide different tmfs for the different age groups, meant to simulate adherence to policy.</p>
<p>The policy measure is implemented on day 30 and maintained for 120 days.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">rknot.events</span> <span class="kn">import</span> <span class="n">SocialDistancing</span> <span class="k">as</span> <span class="n">SD</span>

<span class="n">sd</span> <span class="o">=</span> <span class="n">SD</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">tmfs</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">8</span><span class="p">,</span><span class="o">.</span><span class="mi">8</span><span class="p">,</span><span class="o">.</span><span class="mi">7</span><span class="p">,</span><span class="o">.</span><span class="mi">65</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
<span class="n">events_w_res</span> <span class="o">=</span> <span class="n">events</span> <span class="o">+</span> <span class="p">[</span><span class="n">sd</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events_w_res</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">SimChart</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">chart</span><span class="o">.</span><span class="n">animate</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2020-10-06 11:15:16,375 INFO resource_spec.py:223 -- Starting Ray with 11.13 GiB memory available for workers and up to 5.57 GiB for objects. You can adjust these settings with ray.init(memory=&lt;bytes&gt;, object_store_memory=&lt;bytes&gt;).
2020-10-06 11:15:16,872 INFO services.py:1191 -- View the Ray dashboard at <span class="ansi-green-intense-fg ansi-bold">localhost:8265</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------------------------------------------------------
|                                  SIM DETAILS                                  |
|-------------------------------------------------------------------------------|
|           boundary|  [  1 100   1 100]|             n_locs|              10000|
|-------------------|-------------------|-------------------|-------------------|
|                  n|              10000|            density|                1.0|
|-------------------|-------------------|-------------------|-------------------|
|                ktr|                1.0|                tmr|               0.18|
|-------------------|-------------------|-------------------|-------------------|
</pre></div></div>
</div>
<video width="705" height="340" src="https://storage.googleapis.com/rknotvids/baseus/policy_sd.mp4" controls><p>Video Failed to Load</p>
</video><p>This results in:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Peak</p></td>
<td><p>11%</p></td>
</tr>
<tr class="row-even"><td><p>HIT</p></td>
<td><p>59%</p></td>
</tr>
<tr class="row-odd"><td><p>Fatalities</p></td>
<td><p>0.4%</p></td>
</tr>
</tbody>
</table>
<p>We can see that social distancing is certainly the most effective approach (of the last 3) to “flattening the curve” with spread remarkably limited during the policy period, reaching a peak only after ~175+ days.</p>
<p>Still, once restrictions are lifted the virus spreads unabated and fatalties reach relatively high levels. We can also see the “second wave” effect where infections appear to peak around 100 days, only to rebound and reach a higher peak two months later.</p>
</div>
<div class="section" id="4.-Social-Distancing-and-Restrict-Elderly-Visits-and-Large-Gatherings">
<h3>4. Social Distancing and Restrict Elderly Visits and Large Gatherings<a class="headerlink" href="#4.-Social-Distancing-and-Restrict-Elderly-Visits-and-Large-Gatherings" title="Permalink to this headline">¶</a></h3>
<p>What happens if we combine the three approaches above?</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">large_gatherings</span> <span class="o">=</span> <span class="n">Restriction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;capacity&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">no_visits</span> <span class="o">=</span> <span class="n">Restriction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;no_visits&#39;</span><span class="p">,</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;visit&#39;</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">sd</span> <span class="o">=</span> <span class="n">SD</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">tmfs</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">8</span><span class="p">,</span><span class="o">.</span><span class="mi">8</span><span class="p">,</span><span class="o">.</span><span class="mi">7</span><span class="p">,</span><span class="o">.</span><span class="mi">65</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
<span class="n">events_w_res</span> <span class="o">=</span> <span class="n">events</span> <span class="o">+</span> <span class="p">[</span><span class="n">large_gatherings</span><span class="p">,</span> <span class="n">no_visits</span><span class="p">,</span> <span class="n">sd</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events_w_res</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">SimChart</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">chart</span><span class="o">.</span><span class="n">animate</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2020-10-06 11:15:20,474 INFO resource_spec.py:223 -- Starting Ray with 11.13 GiB memory available for workers and up to 5.58 GiB for objects. You can adjust these settings with ray.init(memory=&lt;bytes&gt;, object_store_memory=&lt;bytes&gt;).
2020-10-06 11:15:20,970 INFO services.py:1191 -- View the Ray dashboard at <span class="ansi-green-intense-fg ansi-bold">localhost:8265</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------------------------------------------------------
|                                  SIM DETAILS                                  |
|-------------------------------------------------------------------------------|
|           boundary|  [  1 100   1 100]|             n_locs|              10000|
|-------------------|-------------------|-------------------|-------------------|
|                  n|              10000|            density|                1.0|
|-------------------|-------------------|-------------------|-------------------|
|                ktr|                1.0|                tmr|               0.18|
|-------------------|-------------------|-------------------|-------------------|
</pre></div></div>
</div>
<video width="705" height="340" src="https://storage.googleapis.com/rknotvids/baseus/sd_%26_no_large_%26_no_visits.mp4" controls><p>Video Failed to Load</p>
</video><p>This results in:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Peak</p></td>
<td><p>9%</p></td>
</tr>
<tr class="row-even"><td><p>HIT</p></td>
<td><p>14%</p></td>
</tr>
<tr class="row-odd"><td><p>Fatalities</p></td>
<td><p>0.4%</p></td>
</tr>
</tbody>
</table>
<p>We can see that this combined approach results in one of the flattest curves yet with the virus slowly declining in a very long tail.</p>
<p>Importantly, however, this does not result in signficantly lower fatalities as an outbreak occurs in the <code class="docutils literal notranslate"><span class="pre">group4b</span></code> gate just before the visit restriction kicks on day 30.</p>
<p>Now is an important time to reiterate that there can be significant variance between simulations run with the same structure. Here is the same simulation, run a second time:</p>
<video width="705" height="340" src="https://storage.googleapis.com/rknotvids/baseus/sd_%26_no_large_%26_no_visits_2.mp4" controls><p>Video Failed to Load</p>
</video><p>This results in:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Peak</p></td>
<td><p>22%</p></td>
</tr>
<tr class="row-even"><td><p>HIT</p></td>
<td><p>54%</p></td>
</tr>
<tr class="row-odd"><td><p>Fatalities</p></td>
<td><p>0.5%</p></td>
</tr>
</tbody>
</table>
<p>In this sim, the measures are almost successful in eradicating the virus, as the infection level cruises at near zero for 160+ days, then the restrictions are lifted in their entirety and virus spreads throughtout the population.</p>
<p><code class="docutils literal notranslate"><span class="pre">group4b</span></code> manages to avoid an outbreak in the early days, but, once travel restrictions are lifted, an otubreak occurs almost immediately, leading to a high level of fatalities.</p>
</div>
<div class="section" id="5.-Quarantine">
<h3>5. Quarantine<a class="headerlink" href="#5.-Quarantine" title="Permalink to this headline">¶</a></h3>
<p>We can even mimick the impact of quarantines via the Quarantine object.</p>
<p>Here we show the impact of a 30-day quarantine for all groups in the Sim.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">rknot.events</span> <span class="kn">import</span> <span class="n">Quarantine</span>

<span class="n">quarantine</span> <span class="o">=</span> <span class="n">Quarantine</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">events_w_res</span> <span class="o">=</span> <span class="n">events</span> <span class="o">+</span> <span class="p">[</span><span class="n">quarantine</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events_w_res</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">SimChart</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">chart</span><span class="o">.</span><span class="n">animate</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2020-10-06 11:15:24,744 INFO resource_spec.py:223 -- Starting Ray with 11.08 GiB memory available for workers and up to 5.56 GiB for objects. You can adjust these settings with ray.init(memory=&lt;bytes&gt;, object_store_memory=&lt;bytes&gt;).
2020-10-06 11:15:25,232 INFO services.py:1191 -- View the Ray dashboard at <span class="ansi-green-intense-fg ansi-bold">localhost:8265</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------------------------------------------------------
|                                  SIM DETAILS                                  |
|-------------------------------------------------------------------------------|
|           boundary|  [  1 100   1 100]|             n_locs|              10000|
|-------------------|-------------------|-------------------|-------------------|
|                  n|              10000|            density|                1.0|
|-------------------|-------------------|-------------------|-------------------|
|                ktr|                1.0|                tmr|               0.18|
|-------------------|-------------------|-------------------|-------------------|
</pre></div></div>
</div>
<video width="705" height="340" src="https://storage.googleapis.com/rknotvids/baseus/quarantine.mp4" controls><p>Video Failed to Load</p>
</video><p>This results in:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Peak</p></td>
<td><p>24%</p></td>
</tr>
<tr class="row-even"><td><p>HIT</p></td>
<td><p>61%</p></td>
</tr>
<tr class="row-odd"><td><p>Fatalities</p></td>
<td><p>0.4%</p></td>
</tr>
</tbody>
</table>
<p>The quarantine measures are effective in suppressing spread during the quarantine, but viral spread continues once the measures are lifted.</p>
</div>
<div class="section" id="6.-Quarantine-Then-Restrictions">
<h3>6. Quarantine Then Restrictions<a class="headerlink" href="#6.-Quarantine-Then-Restrictions" title="Permalink to this headline">¶</a></h3>
<p>We can combine a quarantine with following on policy restrictions to mimick the decisions made by many governments worldwide.</p>
<p>To do this, we will push the start_tick of the restrictions out until the end of the quarantine (quarantines and restrictions cannot overlap).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">large_gatherings</span> <span class="o">=</span> <span class="n">Restriction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">61</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;capacity&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">no_visits</span> <span class="o">=</span> <span class="n">Restriction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;no_visits&#39;</span><span class="p">,</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">61</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;visit&#39;</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">sd</span> <span class="o">=</span> <span class="n">SD</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">tmfs</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">8</span><span class="p">,</span><span class="o">.</span><span class="mi">8</span><span class="p">,</span><span class="o">.</span><span class="mi">7</span><span class="p">,</span><span class="o">.</span><span class="mi">65</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">61</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
<span class="n">quarantine</span> <span class="o">=</span> <span class="n">Quarantine</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">events_w_res</span> <span class="o">=</span> <span class="n">events</span> <span class="o">+</span> <span class="p">[</span><span class="n">large_gatherings</span><span class="p">,</span> <span class="n">no_visits</span><span class="p">,</span> <span class="n">sd</span><span class="p">,</span> <span class="n">quarantine</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events_w_res</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">SimChart</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">chart</span><span class="o">.</span><span class="n">animate</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2020-10-06 11:15:28,961 INFO resource_spec.py:223 -- Starting Ray with 11.08 GiB memory available for workers and up to 5.56 GiB for objects. You can adjust these settings with ray.init(memory=&lt;bytes&gt;, object_store_memory=&lt;bytes&gt;).
2020-10-06 11:15:29,455 INFO services.py:1191 -- View the Ray dashboard at <span class="ansi-green-intense-fg ansi-bold">localhost:8265</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------------------------------------------------------
|                                  SIM DETAILS                                  |
|-------------------------------------------------------------------------------|
|           boundary|  [  1 100   1 100]|             n_locs|              10000|
|-------------------|-------------------|-------------------|-------------------|
|                  n|              10000|            density|                1.0|
|-------------------|-------------------|-------------------|-------------------|
|                ktr|                1.0|                tmr|               0.18|
|-------------------|-------------------|-------------------|-------------------|
</pre></div></div>
</div>
<video width="705" height="340" src="https://storage.googleapis.com/rknotvids/baseus/quarantine_then_restrict.mp4" controls><p>Video Failed to Load</p>
</video><p>This results in:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 83%" />
<col style="width: 17%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Peak</p></td>
<td><p>1%</p></td>
</tr>
<tr class="row-even"><td><p>HIT</p></td>
<td><p>1%</p></td>
</tr>
<tr class="row-odd"><td><p>Fatalities</p></td>
<td><p>0%</p></td>
</tr>
</tbody>
</table>
<p>The pandemic never materializes in this simulation. The combination of policy measures eradicates the virus swiftly.</p>
<p>This is a very interesting result. This obvioulsy did not occur in many places that took this approach. There are several possible reasons worth considering:</p>
<ul class="simple">
<li><p>Random Variation: if you run this simulation multiple times, you will note sims where spread does occur (though fewer than other sims).</p></li>
<li><p>Scale: a larger simulation would increase the possibility that a very small number of dots can continue to pass around the virus while it is largerly muted in the broader population</p></li>
<li><p>Adherence: it is possible that real-world adherence to the implemented policies was much lower than the modeling suggests</p></li>
</ul>
</div>
</div>
<div class="section" id="A-Fulsome-Scenario">
<h2>A Fulsome Scenario<a class="headerlink" href="#A-Fulsome-Scenario" title="Permalink to this headline">¶</a></h2>
<p>We’ll now create a more fulsome scenario encompassing many of the factors discussed.</p>
<p>Adjustments to prior scenarios include:</p>
<ul class="simple">
<li><p>add additional group with <code class="docutils literal notranslate"><span class="pre">mover='social'</span></code> in the 20-49 cohort. this cohort also flaunts social distancing guidelines as so its tmf in the SD object is <code class="docutils literal notranslate"><span class="pre">1.25</span></code></p></li>
<li><p>add susceptibility factors for most groups</p></li>
<li><p>more fine-tuned capacity restrictions that gradually allow larger events over time</p></li>
<li><p>restrict visits to the elderly for a full year</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">### GROUPS ###</span>
<span class="n">group1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;0-19&#39;</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">2700</span><span class="p">,</span>
    <span class="n">n_inf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">ifr</span><span class="o">=</span><span class="mf">0.00003</span><span class="p">,</span>
    <span class="n">mover</span><span class="o">=</span><span class="s1">&#39;local&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">group2a</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;20-49L&#39;</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">3900</span><span class="p">,</span>
    <span class="n">n_inf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ifr</span><span class="o">=</span><span class="mf">0.0002</span><span class="p">,</span>
    <span class="n">mover</span><span class="o">=</span><span class="s1">&#39;local&#39;</span><span class="p">,</span>
    <span class="n">susf</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">group2b</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;20-49S&#39;</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">n_inf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ifr</span><span class="o">=</span><span class="mf">0.0002</span><span class="p">,</span>
    <span class="n">mover</span><span class="o">=</span><span class="s1">&#39;social&#39;</span><span class="p">,</span>
    <span class="n">susf</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">group3</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;50-69&#39;</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">2300</span><span class="p">,</span>
    <span class="n">n_inf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ifr</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
    <span class="n">susf</span><span class="o">=.</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">mover</span><span class="o">=</span><span class="s1">&#39;local&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">group4a</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;70+&#39;</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
    <span class="n">n_inf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">ifr</span><span class="o">=</span><span class="mf">0.042</span><span class="p">,</span>
    <span class="n">mover</span><span class="o">=</span><span class="s1">&#39;local&#39;</span><span class="p">,</span>
    <span class="n">susf</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">group4b</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;70+G&#39;</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">n_inf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">ifr</span><span class="o">=</span><span class="mf">0.0683</span><span class="p">,</span>
    <span class="n">mover</span><span class="o">=</span><span class="s1">&#39;local&#39;</span><span class="p">,</span>
    <span class="n">box</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
    <span class="n">box_is_gated</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2a</span><span class="p">,</span> <span class="n">group2b</span><span class="p">,</span> <span class="n">group3</span><span class="p">,</span> <span class="n">group4a</span><span class="p">,</span> <span class="n">group4b</span><span class="p">]</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dlevel&#39;</span><span class="p">:</span> <span class="s1">&#39;med&#39;</span><span class="p">,</span> <span class="s1">&#39;Ro&#39;</span><span class="p">:</span><span class="mf">2.5</span><span class="p">,</span> <span class="s1">&#39;days&#39;</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="s1">&#39;imndur&#39;</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="s1">&#39;infdur&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">}</span>

<span class="c1">### EVENTS ###</span>
<span class="kn">from</span> <span class="nn">rknot.events</span> <span class="kn">import</span> <span class="n">Event</span><span class="p">,</span> <span class="n">Travel</span>

<span class="n">school1</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;school1&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">25</span><span class="p">,</span><span class="mi">42</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">school2</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;school2&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">78</span><span class="p">,</span><span class="mi">82</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">game</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;game&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">84</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">concert1</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;concert1&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">concert2</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;concert2&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">91</span><span class="p">,</span><span class="mi">92</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">bar</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">bar2</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;bar2&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">87</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">bar3</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;bar3&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">52</span><span class="p">,</span><span class="mi">89</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">church</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;church&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">91</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">church2</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;church&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">visit</span> <span class="o">=</span> <span class="n">Travel</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;visit&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">recurring</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">events</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">school1</span><span class="p">,</span> <span class="n">school2</span><span class="p">,</span>
    <span class="n">game</span><span class="p">,</span> <span class="n">concert1</span><span class="p">,</span> <span class="n">concert2</span><span class="p">,</span> <span class="n">bar</span><span class="p">,</span> <span class="n">bar2</span><span class="p">,</span> <span class="n">bar3</span><span class="p">,</span>
    <span class="n">church</span><span class="p">,</span> <span class="n">church2</span><span class="p">,</span> <span class="n">visit</span><span class="p">,</span>
<span class="p">]</span>

<span class="c1">### RESTRICTIONS ###</span>
<span class="n">small_gatherings</span> <span class="o">=</span> <span class="n">Restriction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;capacity&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">med_gatherings</span> <span class="o">=</span> <span class="n">Restriction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;med&#39;</span><span class="p">,</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;capacity&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">large_gatherings</span> <span class="o">=</span> <span class="n">Restriction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;capacity&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">no_visits</span> <span class="o">=</span> <span class="n">Restriction</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;no_visits&#39;</span><span class="p">,</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">365</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;visit&#39;</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">sd</span> <span class="o">=</span> <span class="n">SD</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">tmfs</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="o">.</span><span class="mi">7</span><span class="p">,</span><span class="o">.</span><span class="mi">65</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">start_tick</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
<span class="n">events_w_res</span> <span class="o">=</span> <span class="n">events</span> <span class="o">+</span> <span class="p">[</span><span class="n">small_gatherings</span><span class="p">,</span> <span class="n">med_gatherings</span><span class="p">,</span> <span class="n">large_gatherings</span><span class="p">,</span> <span class="n">no_visits</span><span class="p">,</span> <span class="n">sd</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="n">events_w_res</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">SimChart</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">chart</span><span class="o">.</span><span class="n">animate</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2020-10-06 11:15:33,293 INFO resource_spec.py:223 -- Starting Ray with 11.08 GiB memory available for workers and up to 5.56 GiB for objects. You can adjust these settings with ray.init(memory=&lt;bytes&gt;, object_store_memory=&lt;bytes&gt;).
2020-10-06 11:15:33,782 INFO services.py:1191 -- View the Ray dashboard at <span class="ansi-green-intense-fg ansi-bold">localhost:8265</span>
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------------------------------------------------------------
|                                  SIM DETAILS                                  |
|-------------------------------------------------------------------------------|
|           boundary|  [  1 100   1 100]|             n_locs|              10000|
|-------------------|-------------------|-------------------|-------------------|
|                  n|              10000|            density|                1.0|
|-------------------|-------------------|-------------------|-------------------|
|                ktr|                1.0|                tmr|               0.18|
|-------------------|-------------------|-------------------|-------------------|
</pre></div></div>
</div>
<video width="705" height="340" src="https://storage.googleapis.com/rknotvids/baseus/fulsome.mp4" controls><p>Video Failed to Load</p>
</video><p>This results in:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Peak</p></td>
<td><p>15%</p></td>
</tr>
<tr class="row-even"><td><p>HIT</p></td>
<td><p>34%</p></td>
</tr>
<tr class="row-odd"><td><p>Fatalities</p></td>
<td><p>0.2%</p></td>
</tr>
</tbody>
</table>
<p>This has the lowest fatality rate of the group and is achieved simply by restricting access to gated region</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="intro.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, rskene

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>